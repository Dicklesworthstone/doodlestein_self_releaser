{"id":"bd-1jt","title":"EPIC: Fallback Release Infrastructure (ACFS)","description":"# Agent-Controlled Fallback System (ACFS) for Multi-Tool Releases\n\n## Background & Problem Statement\n\nGitHub Actions is limiting usage due to high volume (~$5k/month equivalent). When CI/CD jobs stay queued for >10 minutes, it indicates throttling. We need an automated fallback system that:\n\n1. **Detects throttling** - Monitors GH Actions queue time, triggers fallback when jobs sit >10 min\n2. **Builds locally** - Linux on Contabo superserver (css), macOS on Mac mini (mmini)\n3. **Handles Windows** - Cross-compilation or other strategies TBD\n4. **Uploads releases** - Manually create releases and upload binaries when throttled\n5. **Smart installers** - curl|bash one-liners that try release first, build from source if stale\n\n## Infrastructure Available\n\n| Host | Alias | Purpose | Connection |\n|------|-------|---------|------------|\n| Contabo Superserver | css | Linux x86_64/ARM64 builds | ssh css |\n| Mac mini | mmini | macOS ARM64/x86_64 builds | ssh mmini |\n| OVH servers | yto, fmd | Backup build capacity | ssh yto/fmd |\n\n## Tools Affected (16 total from Dicklesworthstone toolchain)\n\ncass, bv, cm, ubs, xf, ru, slb, caam, ntm, br, dcg, ms, wa, pt, rch, mcp_agent_mail\n\n## Languages & Toolchains\n\n- **Rust** (majority): cargo, rustup, cross-compilation via cargo-zigbuild or cross\n- **Go**: go build, goreleaser  \n- **TypeScript/Bun**: bun build, bun compile\n\n## Success Criteria\n\n1. Any tool can be released within 30 minutes even when GH Actions is throttled\n2. curl-bash installers work on Linux/macOS/Windows without manual intervention\n3. Installers auto-detect stale releases (>10 commits behind) and offer source builds\n4. Toolchain installation is automatic and non-destructive\n5. All paths have unit tests and E2E validation scripts with detailed logging\n\n## Key Design Decisions\n\n1. **10-minute threshold**: Chosen as balance between patience and productivity\n2. **Try release first**: Network download is faster than compilation for most users\n3. **Commit-based staleness**: More accurate than date-based (active development = fresh releases)\n4. **Non-destructive toolchains**: Never break existing installations  \n5. **Detailed logging**: Every step logged for debugging failed installs\n\n## Architecture Overview\n\n\\`\\`\\`\n┌─────────────────────────────────────────────────────────────────────┐\n│                    ACFS Release Pipeline                             │\n├─────────────────────────────────────────────────────────────────────┤\n│  [1] Push tag v1.2.3                                                │\n│         │                                                            │\n│         ▼                                                            │\n│  [2] GH Actions triggered                                           │\n│         │                                                            │\n│         ├──→ Queued <10min? ──→ Build & Release (normal path)       │\n│         │                                                            │\n│         └──→ Queued >10min? ──→ ACFS Fallback Triggered             │\n│                    │                                                 │\n│                    ▼                                                 │\n│              [3] Local Builds                                       │\n│                    │                                                 │\n│         ┌─────────┴─────────┬────────────────┐                      │\n│         ▼                   ▼                ▼                      │\n│    Linux (css)        macOS (mmini)    Windows (cross)              │\n│         │                   │                │                      │\n│         └─────────┬─────────┴────────────────┘                      │\n│                   ▼                                                  │\n│              [4] Upload binaries to GitHub Release                  │\n│                   │                                                  │\n│                   ▼                                                  │\n│              [5] Update Homebrew/Scoop formulas                     │\n└─────────────────────────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────────────────────────┐\n│                 Smart Curl-Bash Installer Flow                       │\n├─────────────────────────────────────────────────────────────────────┤\n│  curl -sSL install.sh | bash                                        │\n│         │                                                            │\n│         ▼                                                            │\n│  [1] Detect OS/Arch                                                 │\n│         │                                                            │\n│         ▼                                                            │\n│  [2] Check latest release                                           │\n│         │                                                            │\n│         ├──→ Release exists & fresh (<10 commits behind)?           │\n│         │         │                                                  │\n│         │         └──→ Download binary ──→ Install ──→ Done         │\n│         │                                                            │\n│         └──→ Release missing or stale?                              │\n│                   │                                                  │\n│                   ▼                                                  │\n│         [3] Prompt: \"Build from source?\"                            │\n│                   │                                                  │\n│                   ▼                                                  │\n│         [4] Check/Install toolchain (Rust/Go/Bun)                   │\n│                   │                                                  │\n│                   ▼                                                  │\n│         [5] Clone repo & build                                      │\n│                   │                                                  │\n│                   ▼                                                  │\n│         [6] Install binary ──→ Done                                 │\n└─────────────────────────────────────────────────────────────────────┘\n\\`\\`\\`\n\n## Dependency Graph (high-level themes)\n\n1. **Theme 1: GH Actions Monitoring** - No deps, can start immediately\n2. **Theme 2: Local Build Infrastructure** - Needs monitoring to know when to trigger\n3. **Theme 3: Release Upload Automation** - Needs builds to have artifacts to upload\n4. **Theme 4: Smart Installers** - Can be developed in parallel, integrates with releases\n5. **Theme 5: Testing & Validation** - Depends on all above being implemented","status":"open","priority":0,"issue_type":"epic","created_at":"2026-01-30T13:06:31.768144393Z","created_by":"ubuntu","updated_at":"2026-01-30T13:06:31.768144393Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1jt.1","title":"Theme 1: GH Actions Monitoring & Timeout Detection","description":"# GH Actions Monitoring & Timeout Detection\n\n## Purpose\nDetect when GH Actions runs are throttled (queued >10 minutes) and automatically trigger the fallback build system.\n\n## Rationale\n- GH Actions provides free minutes, but heavy usage leads to throttling\n- Throttled jobs sit in \"queued\" state indefinitely\n- We need to detect this quickly and fail over to local builds\n- 10-minute threshold balances patience with productivity\n\n## Implementation: Bash Script using gh CLI\n\nThe self-releaser is a bash script (dsr.sh) that automates using gh and other tools.\n\n### Core Detection Logic\n\\`\\`\\`bash\n# Check if any workflow runs are queued >10 min\ngh run list --repo \"\\$REPO\" --json status,createdAt,workflowName \\\\\n  | jq -r '.[] | select(.status==\"queued\") | .createdAt' \\\\\n  | while read created; do\n      age_min=\\$(( (\\$(date +%s) - \\$(date -d \"\\$created\" +%s)) / 60 ))\n      if [ \\$age_min -gt 10 ]; then\n        echo \"THROTTLED: Run queued for \\${age_min} minutes\"\n        return 0\n      fi\n    done\n\\`\\`\\`\n\n### Key Components\n1. **dsr check** - Check if GH Actions is throttled for a repo\n2. **dsr watch** - Continuously monitor and trigger fallback when needed\n3. **dsr status** - Show current queue status across all repos\n\n## Success Criteria\n- [ ] Can detect a queued run within 1 minute of hitting 10min mark\n- [ ] False positive rate <1%\n- [ ] Works across all 16 tools' repositories\n- [ ] Clear logging of detection and trigger events\n- [ ] Exit codes: 0=OK, 1=throttled, 2=error\n\n## Dependencies\n- gh CLI (authenticated)\n- jq for JSON parsing\n- date command with GNU extensions (or gdate on macOS)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:07:15.526804311Z","created_by":"ubuntu","updated_at":"2026-01-30T13:07:15.526804311Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.1","depends_on_id":"bd-1jt","type":"parent-child","created_at":"2026-01-30T13:07:15.526804311Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.1.1","title":"Implement dsr check command - detect throttled runs","description":"# Implement `dsr check` — Detect Throttled GH Actions Runs\n\n## Purpose\nDetect when GitHub Actions is throttled (runs stuck in queue) and provide structured data for automation.\n\n## Data Source (GitHub REST API)\nUse the workflow runs endpoint and compute queue time from timestamps:\n- `status` (queued|in_progress|completed)\n- `created_at`\n- `run_started_at` (null when not yet started)\n- `conclusion`\nRef: GitHub REST API – List workflow runs for a repository.\n\n## Command Interface\n```bash\ndsr check <repo>\ndsr check --all\n dsr check <repo> --threshold 10\n dsr check <repo> --json\n```\n\n## Detection Logic (robust)\n1. Resolve short repo → full `owner/repo`\n2. Fetch latest workflow runs via `gh api /repos/{owner}/{repo}/actions/runs`\n3. Treat **queued** runs as throttled when:\n   - `status == \"queued\"` and `now - created_at > threshold`\n4. Treat **stuck** runs as throttled when:\n   - `status == \"in_progress\"` but `run_started_at` is null or older than threshold\n5. Include `event`, `workflow_id`, `head_sha` for context\n6. Cache results for short TTL (e.g., 30–60s) to avoid API spam\n\n## Output (JSON)\n```json\n{\n  \"repo\": \"Dicklesworthstone/ntm\",\n  \"status\": \"throttled\",\n  \"oldest_queued_min\": 15,\n  \"threshold_min\": 10,\n  \"runs\": [\n    {\"id\":12345,\"status\":\"queued\",\"created_at\":\"...\",\"workflow_id\":999}\n  ]\n}\n```\n\n## Error Handling\n- Rate limit → backoff + explicit error message\n- gh not authenticated → exit code 3 (dependency/system)\n- API errors → exit code 2 (error)\n\n## Success Criteria\n- [ ] Correctly flags queued runs using API timestamps\n- [ ] JSON output includes run IDs + workflow IDs\n- [ ] Rate-limited calls recover with backoff\n- [ ] Works across all configured repos","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:07:35.923073198Z","created_by":"ubuntu","updated_at":"2026-01-30T14:39:11.895299987Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.1.1","depends_on_id":"bd-1jt.1","type":"parent-child","created_at":"2026-01-30T13:07:35.923073198Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.1","depends_on_id":"bd-1jt.1.8","type":"blocks","created_at":"2026-01-30T14:39:00.946605637Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.1","depends_on_id":"bd-1jt.1.9","type":"blocks","created_at":"2026-01-30T14:39:11.895264009Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.1","depends_on_id":"bd-1jt.7.1","type":"blocks","created_at":"2026-01-30T14:38:52.255711563Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.1.2","title":"Implement dsr watch command - continuous monitoring daemon","description":"# Implement `dsr watch` — Continuous Monitoring Daemon\n\n## Purpose\nContinuously monitor all configured repos and trigger fallback only when throttling is real, stable, and deduped.\n\n## Design Requirements\n- **Jittered polling** to avoid thundering herds\n- **Debounce** repeated throttling signals (avoid flapping)\n- **Deduplicate** by run ID so each stuck run triggers at most once\n- **Resilient** to temporary API failures (backoff + retry)\n\n## Command Interface\n```bash\ndsr watch\n dsr watch --daemon\n dsr watch --interval 60\n dsr watch --dry-run\n```\n\n## Implementation Notes\n- Reuse `dsr check --json`\n- Track triggered run IDs in `~/.local/state/dsr/triggered.json`\n- Use a lightweight lockfile to avoid multiple watcher instances\n- On startup, run `dsr doctor --quick`\n\n## Success Criteria\n- [ ] Polls all repos at configured interval\n- [ ] Triggers fallback once per throttled run\n- [ ] Exponential backoff on API errors\n- [ ] Daemon mode survives restarts and logs state","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:07:49.072822562Z","created_by":"ubuntu","updated_at":"2026-01-30T14:39:12.167531881Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.1.2","depends_on_id":"bd-1jt.1","type":"parent-child","created_at":"2026-01-30T13:07:49.072822562Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.2","depends_on_id":"bd-1jt.1.1","type":"blocks","created_at":"2026-01-30T13:15:20.660721260Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.2","depends_on_id":"bd-1jt.1.8","type":"blocks","created_at":"2026-01-30T14:39:01.213534509Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.2","depends_on_id":"bd-1jt.1.9","type":"blocks","created_at":"2026-01-30T14:39:12.167502295Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.2","depends_on_id":"bd-1jt.7.1","type":"blocks","created_at":"2026-01-30T14:38:52.515880942Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.1.3","title":"Implement dsr repos command - manage tool registry","description":"# Implement dsr repos command\n\n## What This Does\nManage the list of repositories that dsr monitors and can build.\n\n## Command Interface\n\\`\\`\\`bash\ndsr repos list             # List all configured repos\ndsr repos add ntm          # Add a repo to monitor\ndsr repos remove ntm       # Remove a repo\ndsr repos info ntm         # Show repo details (language, build cmd, etc.)\n\\`\\`\\`\n\n## Repository Configuration\nStore in ~/.config/dsr/repos.yaml:\n\n\\`\\`\\`yaml\nrepos:\n  ntm:\n    full_name: Dicklesworthstone/ntm\n    language: go\n    build_cmd: \"go build -o ntm ./cmd/ntm\"\n    targets:\n      - linux-amd64\n      - darwin-arm64\n      - darwin-amd64\n      - windows-amd64\n    \n  cass:\n    full_name: Dicklesworthstone/coding_agent_session_search\n    language: rust\n    build_cmd: \"cargo build --release\"\n    targets:\n      - x86_64-unknown-linux-gnu\n      - aarch64-apple-darwin\n      - x86_64-apple-darwin\n      - x86_64-pc-windows-msvc\n    \n  bv:\n    full_name: Dicklesworthstone/beads_viewer\n    language: go\n    # ... etc\n\\`\\`\\`\n\n## Auto-Discovery\n\\`dsr repos discover\\` could scan /data/projects and detect:\n- Language from Cargo.toml, go.mod, package.json\n- Existing GH Actions workflows for target hints\n- README for any special build instructions\n\n## Success Criteria\n- [ ] List shows all 16 tools with their languages\n- [ ] Add/remove works and persists\n- [ ] Info shows complete build configuration\n- [ ] Config file format is human-editable\n\n## Pre-populated Data\nShip with default config for all 16 tools:\ncass, bv, cm, ubs, xf, ru, slb, caam, ntm, br, dcg, ms, wa, pt, rch, mcp_agent_mail","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T13:08:02.877692893Z","created_by":"ubuntu","updated_at":"2026-01-30T14:39:01.477512547Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.1.3","depends_on_id":"bd-1jt.1","type":"parent-child","created_at":"2026-01-30T13:08:02.877692893Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.3","depends_on_id":"bd-1jt.1.8","type":"blocks","created_at":"2026-01-30T14:39:01.477484654Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.3","depends_on_id":"bd-1jt.7.1","type":"blocks","created_at":"2026-01-30T14:38:52.755481675Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.1.4","title":"Implement dsr fallback command - trigger local build pipeline","description":"# Implement dsr fallback Command\n\n## Purpose\nOrchestrate the full fallback process: detect throttling, build locally, upload release.\n\n## Command Interface\n\\`\\`\\`bash\ndsr fallback <tool>              # Full fallback: build + release\ndsr fallback <tool> --build-only # Just build, don't release\ndsr fallback <tool> --version v1.2.3  # Explicit version\n\\`\\`\\`\n\n## Fallback Flow\n\\`\\`\\`\n1. Verify throttling (optional, can be skipped if already checked)\n2. Get version from git tag or argument\n3. Build for all targets (parallel)\n   - Linux x64, ARM64 on css\n   - macOS ARM64, x64 on mmini\n   - Windows via cross-compile\n4. Collect artifacts locally\n5. Generate checksums\n6. Create GitHub release\n7. Upload all artifacts\n8. Verify release is complete\n\\`\\`\\`\n\n## Implementation\n\\`\\`\\`bash\ndsr_fallback() {\n  local tool=\"\\$1\"\n  local version=\"\\${2:-\\$(get_version_from_tag)}\"\n  \n  log \"Starting fallback release for \\$tool \\$version\"\n  \n  # Build all targets\n  log \"Building...\"\n  dsr build \"\\$tool\" --version \"\\$version\" --parallel || die \"Build failed\"\n  \n  # Create release\n  log \"Creating release...\"\n  dsr release \"\\$tool\" \"\\$version\" || die \"Release failed\"\n  \n  log \"✓ Fallback complete: \\$tool \\$version\"\n}\n\\`\\`\\`\n\n## Notifications\nOn completion/failure, notify via:\n- Terminal notification (osascript/notify-send)\n- Optional: Slack webhook\n- Optional: Email\n\n## Logging\nAll steps logged to:\n~/.local/state/dsr/fallback-{tool}-{version}-{timestamp}.log\n\n## Success Criteria\n- [ ] Full pipeline works end-to-end\n- [ ] Parallel builds complete within 30 min\n- [ ] Release has all expected artifacts\n- [ ] Clear error messages on failure\n- [ ] Logs capture full detail for debugging","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:11:15.916878317Z","created_by":"ubuntu","updated_at":"2026-01-30T14:39:53.153821133Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.1.4","depends_on_id":"bd-1jt.1","type":"parent-child","created_at":"2026-01-30T13:11:15.916878317Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.4","depends_on_id":"bd-1jt.1.1","type":"blocks","created_at":"2026-01-30T13:15:22.493809925Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.4","depends_on_id":"bd-1jt.1.3","type":"blocks","created_at":"2026-01-30T13:15:24.305418681Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.4","depends_on_id":"bd-1jt.1.6","type":"blocks","created_at":"2026-01-30T14:23:54.356537127Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.4","depends_on_id":"bd-1jt.1.8","type":"blocks","created_at":"2026-01-30T14:39:01.728059443Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.4","depends_on_id":"bd-1jt.2.1","type":"blocks","created_at":"2026-01-30T13:15:42.867905477Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.4","depends_on_id":"bd-1jt.3.1","type":"blocks","created_at":"2026-01-30T13:15:45.336100723Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.4","depends_on_id":"bd-1jt.3.11","type":"blocks","created_at":"2026-01-30T14:39:53.153792038Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.4","depends_on_id":"bd-1jt.7.1","type":"blocks","created_at":"2026-01-30T14:38:53.012119556Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.1.5","title":"Create default repos.yaml with all 16 tools configured","description":"# Create Default repos.yaml Configuration\n\n## Purpose\nPre-configure all 16 Dicklesworthstone tools so dsr works out-of-the-box.\n\n## Location\n~/.config/dsr/repos.yaml\n\n## Configuration Format\n\\`\\`\\`yaml\n# DSR Tool Registry\n# Each tool has: repo name, language, local path, and workflow file\n\ntools:\n  # === Rust Tools ===\n  cass:\n    repo: Dicklesworthstone/coding_agent_session_search\n    language: rust\n    local_path: /data/projects/coding_agent_session_search\n    workflow: .github/workflows/release.yml\n    \n  br:\n    repo: Dicklesworthstone/beads_rust\n    language: rust\n    local_path: /data/projects/beads_rust\n    workflow: .github/workflows/release.yml\n    \n  xf:\n    repo: Dicklesworthstone/xf\n    language: rust\n    local_path: /data/projects/xf\n    workflow: .github/workflows/release.yml\n    \n  ubs:\n    repo: Dicklesworthstone/ubs\n    language: rust\n    local_path: /data/projects/ubs\n    workflow: .github/workflows/release.yml\n    \n  dcg:\n    repo: Dicklesworthstone/destructive_command_guard\n    language: rust\n    local_path: /data/projects/destructive_command_guard\n    workflow: .github/workflows/release.yml\n    \n  slb:\n    repo: Dicklesworthstone/slb\n    language: rust\n    local_path: /data/projects/slb\n    workflow: .github/workflows/release.yml\n    \n  rch:\n    repo: Dicklesworthstone/rch\n    language: rust\n    local_path: /data/projects/rch\n    workflow: .github/workflows/release.yml\n    \n  # === Go Tools ===\n  ntm:\n    repo: Dicklesworthstone/ntm\n    language: go\n    local_path: /data/projects/ntm\n    workflow: .github/workflows/release.yml\n    \n  bv:\n    repo: Dicklesworthstone/beads_viewer\n    language: go\n    local_path: /data/projects/beads_viewer\n    workflow: .github/workflows/release.yml\n    \n  ru:\n    repo: Dicklesworthstone/repo_updater\n    language: go\n    local_path: /data/projects/repo_updater\n    workflow: .github/workflows/release.yml\n    \n  caam:\n    repo: Dicklesworthstone/caam\n    language: go\n    local_path: /data/projects/caam\n    workflow: .github/workflows/release.yml\n    \n  cm:\n    repo: Dicklesworthstone/cass_memory_system\n    language: go\n    local_path: /data/projects/cass_memory_system\n    workflow: .github/workflows/release.yml\n    \n  pt:\n    repo: Dicklesworthstone/pt\n    language: go\n    local_path: /data/projects/pt\n    workflow: .github/workflows/release.yml\n    \n  wa:\n    repo: Dicklesworthstone/wa\n    language: go\n    local_path: /data/projects/wa\n    workflow: .github/workflows/release.yml\n    \n  ms:\n    repo: Dicklesworthstone/ms\n    language: go\n    local_path: /data/projects/ms\n    workflow: .github/workflows/release.yml\n    \n  # === TypeScript/MCP Tools ===\n  mcp_agent_mail:\n    repo: Dicklesworthstone/mcp_agent_mail\n    language: typescript\n    local_path: /data/projects/mcp_agent_mail\n    workflow: .github/workflows/release.yml\n\n# Build host preferences\nbuild_hosts:\n  linux:\n    primary: css\n    fallback: yto\n  macos:\n    primary: mmini\n  windows:\n    strategy: cross-compile\n    host: css\n\n# Monitoring settings\nmonitoring:\n  throttle_threshold_minutes: 10\n  poll_interval_seconds: 60\n  max_retries: 3\n\\`\\`\\`\n\n## Auto-Discovery Command\nOptionally add \\`dsr repos discover\\` to scan /data/projects and auto-populate:\n\\`\\`\\`bash\nfor dir in /data/projects/*/; do\n  if [ -f \"\\$dir/Cargo.toml\" ]; then\n    lang=\"rust\"\n  elif [ -f \"\\$dir/go.mod\" ]; then\n    lang=\"go\"\n  elif [ -f \"\\$dir/package.json\" ]; then\n    lang=\"typescript\"\n  else\n    continue\n  fi\n  \n  # Extract repo from git remote\n  repo=\\$(cd \"\\$dir\" && git remote get-url origin | sed 's|.*github.com/||;s|\\.git||')\n  \n  echo \"Found: \\$repo (\\$lang)\"\ndone\n\\`\\`\\`\n\n## Success Criteria\n- [ ] All 16 tools configured\n- [ ] Local paths are correct\n- [ ] Workflows exist in each repo\n- [ ] Languages correctly identified\n- [ ] Build hosts configured","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T13:14:13.167130536Z","created_by":"ubuntu","updated_at":"2026-01-30T13:14:13.167130536Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.1.5","depends_on_id":"bd-1jt.1","type":"parent-child","created_at":"2026-01-30T13:14:13.167130536Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.1.6","title":"Implement notification system for build status","description":"# Notification System for Build Status\n\n## Purpose\nAlert the user when builds complete, fail, or require attention. Critical for long-running background operations.\n\n## Notification Events\n1. **Build started** - Which tool, which hosts\n2. **Build progress** - Per-host status updates\n3. **Build completed** - Success with artifact summary\n4. **Build failed** - Error details and logs location\n5. **Throttling detected** - GH Actions queue time exceeded\n6. **Release published** - Link to GitHub release\n\n## Notification Channels\n\n### 1. Terminal (Default)\n\\`\\`\\`bash\n# macOS\nosascript -e 'display notification \"ntm v1.5.2 build complete\" with title \"dsr\"'\n\n# Linux\nnotify-send \"dsr\" \"ntm v1.5.2 build complete\"\n\n# Cross-platform fallback\necho -e '\\a'  # Terminal bell\n\\`\\`\\`\n\n### 2. ntm Integration (if running in agent swarm)\n\\`\\`\\`bash\n# Send to ntm overseer\nntm notify \"dsr build complete: ntm v1.5.2\" --level success\n\n# Or via Agent Mail\nntm send --to HumanOverseer --subject \"Build Complete\" --body \"...\"\n\\`\\`\\`\n\n### 3. Slack Webhook (Optional)\n\\`\\`\\`bash\nsend_slack() {\n  local msg=\"\\$1\"\n  local webhook=\"\\$DSR_SLACK_WEBHOOK\"\n  [ -z \"\\$webhook\" ] && return\n  \n  curl -sSL -X POST -H 'Content-type: application/json' \\\\\n    --data \"{\\\"text\\\":\\\"\\$msg\\\"}\" \"\\$webhook\"\n}\n\\`\\`\\`\n\n### 4. Email (Optional, via sendmail/msmtp)\n\\`\\`\\`bash\nsend_email() {\n  local subject=\"\\$1\"\n  local body=\"\\$2\"\n  local to=\"\\${DSR_EMAIL:-}\"\n  [ -z \"\\$to\" ] && return\n  \n  echo \"\\$body\" | mail -s \"\\$subject\" \"\\$to\"\n}\n\\`\\`\\`\n\n## Configuration\n~/.config/dsr/notifications.yaml:\n\\`\\`\\`yaml\nnotifications:\n  terminal: true          # Always\n  ntm: auto               # If ntm is running\n  slack:\n    enabled: false\n    webhook: \"\"\n  email:\n    enabled: false\n    to: \"\"\n  \n  # Event filtering\n  events:\n    build_started: false  # Too noisy\n    build_progress: false\n    build_completed: true\n    build_failed: true\n    throttle_detected: true\n    release_published: true\n\\`\\`\\`\n\n## Implementation\n\\`\\`\\`bash\nnotify() {\n  local level=\"\\$1\"   # info|success|warning|error\n  local title=\"\\$2\"\n  local message=\"\\$3\"\n  \n  local config=\\$(load_notification_config)\n  \n  # Terminal notification\n  if [ \"\\$(echo \\$config | jq -r '.terminal')\" = \"true\" ]; then\n    notify_terminal \"\\$level\" \"\\$title\" \"\\$message\"\n  fi\n  \n  # ntm integration\n  if [ \"\\$(echo \\$config | jq -r '.ntm')\" = \"auto\" ]; then\n    if pgrep -x ntm >/dev/null; then\n      ntm notify \"\\$message\" --level \"\\$level\" 2>/dev/null || true\n    fi\n  fi\n  \n  # Slack\n  if [ \"\\$(echo \\$config | jq -r '.slack.enabled')\" = \"true\" ]; then\n    send_slack \"\\$title: \\$message\"\n  fi\n  \n  # Log all notifications\n  log_json \"{\\\"type\\\":\\\"notification\\\",\\\"level\\\":\\\"\\$level\\\",\\\"title\\\":\\\"\\$title\\\",\\\"message\\\":\\\"\\$message\\\"}\"\n}\n\\`\\`\\`\n\n## Usage in dsr\n\\`\\`\\`bash\ndsr_build() {\n  notify \"info\" \"Build Started\" \"Building \\$tool \\$version on \\$hosts\"\n  \n  if build_all_targets; then\n    notify \"success\" \"Build Complete\" \"All targets built successfully\"\n  else\n    notify \"error\" \"Build Failed\" \"Check logs: ~/.local/state/dsr/builds/...\"\n  fi\n}\n\\`\\`\\`\n\n## Success Criteria\n- [ ] Terminal notifications work on macOS and Linux\n- [ ] ntm integration works when ntm is running\n- [ ] Notifications are non-blocking (don't slow builds)\n- [ ] Can disable noisy events\n- [ ] All notifications logged\n- [ ] Slack webhook works if configured","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T13:24:21.269569798Z","created_by":"ubuntu","updated_at":"2026-01-30T14:39:02.732843656Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.1.6","depends_on_id":"bd-1jt.1","type":"parent-child","created_at":"2026-01-30T13:24:21.269569798Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.6","depends_on_id":"bd-1jt.1.8","type":"blocks","created_at":"2026-01-30T14:39:02.732813620Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.1.7","title":"Implement auto-tag from version files","description":"# Auto-Tag from Version Files\n\n## Purpose\nAutomatically create git tags when version files (Cargo.toml, package.json, VERSION) are updated. Mirrors release-automation.yml pattern.\n\n## Version Sources\n| Language | File | Pattern |\n|----------|------|---------|\n| Rust | Cargo.toml | version = \"X.Y.Z\" |\n| Go | version.go or VERSION | const Version = |\n| Bun/Node | package.json | \"version\": \"X.Y.Z\" |\n| Python | pyproject.toml | version = \"X.Y.Z\" |\n\n## Implementation\n```bash\ndetect_version() {\n  local tool=\"$1\"\n  cd \"/data/projects/$tool\"\n  \n  if [ -f Cargo.toml ]; then\n    sed -n 's/^version = \"\\(.*\\)\"/\\1/p' Cargo.toml | head -1\n  elif [ -f package.json ]; then\n    jq -r .version package.json\n  elif [ -f VERSION ]; then\n    cat VERSION | tr -d '\\n'\n  fi\n}\n\nauto_tag() {\n  local tool=\"$1\"\n  local version=$(detect_version \"$tool\")\n  local latest=$(git tag --list 'v*' --sort=-v:refname | head -1)\n  \n  if [ \"v$version\" != \"$latest\" ]; then\n    git tag -a \"v$version\" -m \"Release v$version\"\n    git push origin \"v$version\"\n  fi\n}\n```\n\n## dsr Command\n```bash\ndsr version detect <tool>   # Show current version\ndsr version tag <tool>      # Create tag if needed\ndsr version tag --all       # Tag all repos with new versions\n```\n\n## Success Criteria\n- [ ] Detect version from all language files\n- [ ] Skip if tag already exists\n- [ ] Create annotated tags\n- [ ] Push tags to remote","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T13:28:57.429934130Z","created_by":"ubuntu","updated_at":"2026-01-30T13:30:48.310092824Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.1.7","depends_on_id":"bd-1jt.1","type":"parent-child","created_at":"2026-01-30T13:28:57.429934130Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.7","depends_on_id":"bd-1jt.1.3","type":"blocks","created_at":"2026-01-30T13:30:48.309988979Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.1.8","title":"Implement dsr config command and configuration management","description":"# dsr Configuration Management (XDG + Schema Validation)\n\n## Purpose\nCentralize configuration so every command uses the same sources of truth for repos, hosts, secrets, and behavior defaults. Consistent config prevents silent drift and makes automation reproducible.\n\n## XDG Layout\n- `~/.config/dsr/`\n  - `config.yaml` (global defaults)\n  - `repos.yaml` (tool registry)\n  - `hosts.yaml` (build hosts + capabilities)\n  - `notifications.yaml` (channels + filters)\n- `~/.cache/dsr/` (API cache, downloaded assets)\n- `~/.local/state/dsr/` (logs, build state, run history)\n\n## Precedence Rules\n1. CLI flags\n2. Environment variables (`DSR_*`)\n3. Config files\n4. Built-in defaults\n\n## Commands\n```bash\ndsr config init                # Create default files\n dsr config show [key]          # Print resolved config\n dsr config validate            # Schema + value validation\n dsr config set KEY=VALUE       # Update config.yaml\n dsr config edit                # Open in $EDITOR\n```\n\n## Schema Expectations\n- Validate required fields (repos, build targets, host aliases)\n- Validate enums (log level, modes)\n- Validate path existence and permissions\n- Reject unknown keys unless `--allow-unknown`\n\n## Success Criteria\n- [ ] Config loads at startup with deterministic precedence\n- [ ] Validation catches missing/invalid keys\n- [ ] Defaults are sane and documented\n- [ ] `--json` outputs resolved config for automation","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T14:23:27.935807062Z","created_by":"ubuntu","updated_at":"2026-01-30T14:38:53.251207574Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.1.8","depends_on_id":"bd-1jt.7","type":"parent-child","created_at":"2026-01-30T14:33:56.274007404Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.1.8","depends_on_id":"bd-1jt.7.1","type":"blocks","created_at":"2026-01-30T14:38:53.251178068Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.1.9","title":"Implement GitHub API adapter with caching + rate-limit handling","description":"# Implement GitHub API Adapter with Caching + Rate-Limit Handling\n\n## Purpose\nCentralize all GitHub API access so commands are consistent, cached, and resilient to rate limits.\n\n## Responsibilities\n- Prefer gh api when available (auth + pagination)\n- Fallback to curl + GITHUB_TOKEN\n- Support ETag / If-None-Match caching in ~/.cache/dsr/github/\n- Normalize errors into a common JSON shape\n- Expose helpers for workflow runs, releases, tags, and compare endpoints\n\n## Success Criteria\n- [ ] Unified helper used by dsr check/watch/release\n- [ ] API responses cached with TTL + ETag\n- [ ] Rate-limit errors trigger backoff + clear messages\n- [ ] All errors map to global exit codes","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T14:36:31.418006660Z","created_by":"ubuntu","updated_at":"2026-01-30T14:36:31.418006660Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.1.9","depends_on_id":"bd-1jt.1","type":"parent-child","created_at":"2026-01-30T14:36:31.418006660Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.2","title":"Theme 2: Local Build Infrastructure","description":"# Local Build Infrastructure\n\n## Purpose\nBuild binaries locally when GH Actions is throttled, using available hardware:\n- Linux builds on Contabo superserver (css)\n- macOS builds on Mac mini (mmini)\n- Windows via cross-compilation\n\n## Build Hosts\n\n### Contabo Superserver (css)\n- Connection: ssh css (alias in ~/.ssh/config)\n- OS: Ubuntu Linux\n- Arch: x86_64\n- Can build: Linux x86_64, Linux ARM64 (via cross), Windows (via cross)\n- Toolchains needed: Rust, Go, Bun\n\n### Mac mini (mmini)\n- Connection: ssh mmini (via Tailscale)\n- OS: macOS\n- Arch: ARM64 (Apple Silicon)\n- Can build: macOS ARM64 (native), macOS x86_64 (via arch -x86_64)\n- Toolchains needed: Rust, Go, Bun\n\n### Cross-Compilation Strategy\nFor targets we can't build natively:\n- Rust: cargo-zigbuild or cross for Windows/ARM\n- Go: GOOS/GOARCH environment variables\n- Bun: bun compile with target flag\n\n## Key Commands\n\\`\\`\\`bash\ndsr build ntm                    # Build for all targets\ndsr build ntm --target linux-amd64  # Specific target\ndsr build ntm --host css         # Force specific build host\n\\`\\`\\`\n\n## Target Matrix\n\n| Tool | Language | Linux x64 | Linux ARM | macOS ARM | macOS x64 | Windows |\n|------|----------|-----------|-----------|-----------|-----------|---------|\n| ntm  | Go       | css       | css/cross | mmini     | mmini     | css     |\n| cass | Rust     | css       | css/cross | mmini     | mmini     | css     |\n| bv   | Go       | css       | css/cross | mmini     | mmini     | css     |\n| ...  | ...      | ...       | ...       | ...       | ...       | ...     |\n\n## Build Output\nAll binaries go to: /tmp/dsr-builds/<tool>/<version>/<target>/\nExample: /tmp/dsr-builds/ntm/v1.5.1/linux-amd64/ntm\n\n## Dependencies\n- SSH access to build hosts\n- Toolchains installed on each host\n- Network connectivity\n- Sufficient disk space (~5GB per full build)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:08:17.777193563Z","created_by":"ubuntu","updated_at":"2026-01-30T13:08:17.777193563Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.2","depends_on_id":"bd-1jt","type":"parent-child","created_at":"2026-01-30T13:08:17.777193563Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.2.1","title":"Implement dsr build command - local compilation","description":"# Implement dsr build command\n\n## What This Does\nCompile a tool locally or on a remote build host, producing release-ready binaries.\n\n## Command Interface\n\\`\\`\\`bash\ndsr build <tool>                      # Build all targets\ndsr build <tool> --target <target>    # Specific target\ndsr build <tool> --host <host>        # Force build host\ndsr build <tool> --version v1.2.3     # Set version\ndsr build <tool> --output-dir <dir>   # Custom output location\ndsr build <tool> --parallel           # Build targets in parallel\n\\`\\`\\`\n\n## Build Flow\n\n### 1. Resolve Configuration\n\\`\\`\\`bash\nconfig=\\$(dsr repos info \"\\$tool\" --json)\nlanguage=\\$(echo \\$config | jq -r '.language')\nbuild_cmd=\\$(echo \\$config | jq -r '.build_cmd')\ntargets=\\$(echo \\$config | jq -r '.targets[]')\n\\`\\`\\`\n\n### 2. For Each Target, Select Build Host\n\\`\\`\\`\nlinux-amd64   → css (native)\nlinux-arm64   → css (cross-compile)\ndarwin-arm64  → mmini (native)\ndarwin-amd64  → mmini (arch -x86_64)\nwindows-amd64 → css (cross-compile)\n\\`\\`\\`\n\n### 3. Execute Build on Host\n\\`\\`\\`bash\n# For remote hosts\nssh \"\\$host\" \"cd /tmp/dsr-build && \\\\\n  git clone --depth 1 https://github.com/\\$repo.git && \\\\\n  cd \\$tool && \\\\\n  \\$build_cmd && \\\\\n  cp target/release/\\$tool /tmp/dsr-builds/\\$tool/\\$version/\\$target/\"\n\\`\\`\\`\n\n### 4. Collect Artifacts\n\\`\\`\\`bash\n# Copy back from remote\nscp \"\\$host:/tmp/dsr-builds/\\$tool/\\$version/\\$target/\\$tool\" \\\\\n    \"./builds/\\$tool-\\$version-\\$target\"\n\\`\\`\\`\n\n## Language-Specific Build Commands\n\n### Rust\n\\`\\`\\`bash\n# Native\ncargo build --release\n\n# Cross-compile (using cargo-zigbuild)\ncargo zigbuild --release --target x86_64-pc-windows-gnu\ncargo zigbuild --release --target aarch64-unknown-linux-gnu\n\\`\\`\\`\n\n### Go\n\\`\\`\\`bash\n# Native\ngo build -o \"\\$output\" ./cmd/\\$tool\n\n# Cross-compile\nGOOS=windows GOARCH=amd64 go build -o \"\\$output.exe\" ./cmd/\\$tool\nGOOS=linux GOARCH=arm64 go build -o \"\\$output\" ./cmd/\\$tool\n\\`\\`\\`\n\n### Bun/TypeScript\n\\`\\`\\`bash\nbun build --compile --target=bun-linux-x64 ./src/index.ts --outfile \"\\$output\"\nbun build --compile --target=bun-darwin-arm64 ./src/index.ts --outfile \"\\$output\"\n\\`\\`\\`\n\n## Output Structure\n\\`\\`\\`\n./builds/\n  ntm-v1.5.1-linux-amd64\n  ntm-v1.5.1-linux-arm64\n  ntm-v1.5.1-darwin-arm64\n  ntm-v1.5.1-darwin-amd64\n  ntm-v1.5.1-windows-amd64.exe\n\\`\\`\\`\n\n## Success Criteria\n- [ ] Builds all 5 standard targets for any tool\n- [ ] Handles Rust, Go, and Bun projects\n- [ ] Remote build via SSH works reliably\n- [ ] Build artifacts are correctly named\n- [ ] Build logs captured for debugging\n- [ ] Parallel builds work without conflicts\n\n## Error Handling\n- SSH connection fails → Retry 3x, then error with host status\n- Build fails → Capture full log, report specific error\n- Missing toolchain → Report which toolchain, suggest fix","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:08:35.463350565Z","created_by":"ubuntu","updated_at":"2026-01-30T14:39:36.399628488Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.2.1","depends_on_id":"bd-1jt.1.8","type":"blocks","created_at":"2026-01-30T14:39:01.980199839Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.1","depends_on_id":"bd-1jt.2","type":"parent-child","created_at":"2026-01-30T13:08:35.463350565Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.1","depends_on_id":"bd-1jt.2.11","type":"blocks","created_at":"2026-01-30T14:39:16.578184844Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.1","depends_on_id":"bd-1jt.2.12","type":"blocks","created_at":"2026-01-30T14:39:22.121844218Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.1","depends_on_id":"bd-1jt.2.13","type":"blocks","created_at":"2026-01-30T14:39:36.399572372Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.1","depends_on_id":"bd-1jt.2.2","type":"blocks","created_at":"2026-01-30T13:15:37.047805374Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.1","depends_on_id":"bd-1jt.2.3","type":"blocks","created_at":"2026-01-30T13:15:38.288823409Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.1","depends_on_id":"bd-1jt.2.4","type":"blocks","created_at":"2026-01-30T13:15:26.813507877Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.1","depends_on_id":"bd-1jt.2.5","type":"blocks","created_at":"2026-01-30T13:15:40.178361572Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.1","depends_on_id":"bd-1jt.2.6","type":"blocks","created_at":"2026-01-30T13:15:28.345714914Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.1","depends_on_id":"bd-1jt.2.7","type":"blocks","created_at":"2026-01-30T13:17:06.737036001Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.1","depends_on_id":"bd-1jt.2.8","type":"blocks","created_at":"2026-01-30T13:26:47.825725483Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.1","depends_on_id":"bd-1jt.7.1","type":"blocks","created_at":"2026-01-30T14:38:53.508442870Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.2.10","title":"Validate GoReleaser config compatibility for each tool","description":"# GoReleaser Config Validation\n\n## Purpose\nEnsure dsr can correctly parse and replicate GoReleaser configurations. Many tools use GoReleaser for cross-compilation and release asset naming.\n\n## Why This Matters\n- GoReleaser defines asset naming conventions\n- Archive formats (.tar.gz vs .zip)\n- Platform-specific builds\n- Homebrew/Scoop formula generation\n\n## .goreleaser.yaml Analysis\n```bash\nanalyze_goreleaser() {\n  local tool=\"$1\"\n  local config=\"/data/projects/$tool/.goreleaser.yaml\"\n  \n  if [ ! -f \"$config\" ]; then\n    echo \"No GoReleaser config found\"\n    return 1\n  fi\n  \n  # Extract build targets\n  yq '.builds[].goos[]' \"$config\"\n  yq '.builds[].goarch[]' \"$config\"\n  \n  # Extract archive format\n  yq '.archives[].format' \"$config\"\n  \n  # Extract naming template\n  yq '.archives[].name_template' \"$config\"\n}\n```\n\n## dsr Compatibility\nFor Go tools with GoReleaser:\n1. Parse .goreleaser.yaml\n2. Run goreleaser locally (if installed)\n3. Or replicate build matrix in bash\n\n```bash\nreplicate_goreleaser() {\n  local tool=\"$1\"\n  local version=\"$2\"\n  \n  # Read targets from config\n  for goos in $(yq '.builds[0].goos[]' .goreleaser.yaml); do\n    for goarch in $(yq '.builds[0].goarch[]' .goreleaser.yaml); do\n      GOOS=$goos GOARCH=$goarch go build -o \"dist/${tool}-${version}-${goos}-${goarch}\" ./cmd/$tool\n    done\n  done\n}\n```\n\n## dsr Command\n```bash\ndsr goreleaser check <tool>      # Validate config\ndsr goreleaser build <tool>      # Build using goreleaser\ndsr goreleaser emulate <tool>    # Build without goreleaser\n```\n\n## Success Criteria\n- [ ] Parse all .goreleaser.yaml files\n- [ ] Produce identical artifacts\n- [ ] Handle archives and checksums\n- [ ] Support Go, Rust, Bun tools","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T13:30:21.603418246Z","created_by":"ubuntu","updated_at":"2026-01-30T13:30:49.305093990Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.2.10","depends_on_id":"bd-1jt.2","type":"parent-child","created_at":"2026-01-30T13:30:21.603418246Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.10","depends_on_id":"bd-1jt.2.2","type":"blocks","created_at":"2026-01-30T13:30:49.305063723Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.2.11","title":"Implement build workspace isolation + lock/state machine","description":"# Implement Build Workspace Isolation + Lock/State Machine\n\n## Purpose\nPrevent overlapping builds and enable reliable resume/retry by persisting build state per tool/version.\n\n## Key Behaviors\n- Acquire lock per tool+version (e.g., ~/.local/state/dsr/locks/<tool>-<version>.lock)\n- Create unique run_id + workspace (no overwrites)\n- Persist state JSON with per-host status + artifacts\n- Resume uses state to skip completed hosts\n\n## Error Handling\n- Never use set -e; capture exit codes and continue where safe\n- Explicitly mark host failures in state\n- Partial success should not block release if policy allows\n\n## Success Criteria\n- [ ] Concurrent runs are blocked or queued\n- [ ] State file created and updated per host\n- [ ] --resume continues from last known state\n- [ ] Logs reference run_id + state path","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T14:36:39.000455353Z","created_by":"ubuntu","updated_at":"2026-01-30T14:36:39.000455353Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.2.11","depends_on_id":"bd-1jt.2","type":"parent-child","created_at":"2026-01-30T14:36:39.000455353Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.2.12","title":"Define artifact naming + build manifest schema","description":"# Define Artifact Naming + Build Manifest Schema\n\n## Purpose\nStandardize artifact names and produce a single manifest JSON that downstream steps (release, installers, tests) can trust.\n\n## Naming Contract\n- {tool}-{version}-{os}-{arch}[.exe]\n- checksums.sha256 must include all binaries\n- optional: .minisig for each artifact\n\n## Manifest File\nLocation: ~/.local/state/dsr/builds/<tool>/<version>/<run_id>/manifest.json\nFields:\n- tool, version, run_id\n- artifacts: name, target, sha256, size_bytes\n- build_hosts + durations\n- git_sha + workflow metadata (if act)\n\n## Success Criteria\n- [ ] Manifest produced for every build\n- [ ] Release + installer use manifest as source of truth\n- [ ] Tests validate manifest schema","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T14:36:45.903938160Z","created_by":"ubuntu","updated_at":"2026-01-30T14:36:45.903938160Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.2.12","depends_on_id":"bd-1jt.2","type":"parent-child","created_at":"2026-01-30T14:36:45.903938160Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.2.13","title":"Create act workflow compatibility matrix + overrides","description":"# Create act Workflow Compatibility Matrix + Overrides\n\n## Purpose\nEnsure each tool's release workflow can be executed locally via act with correct job names, runner images, and artifact paths.\n\n## Deliverables\n- Matrix file: tool -> workflow file -> job names -> act flags\n- Known exceptions (jobs that cannot run in act)\n- Per-host overrides (linux/amd64 vs linux/arm64)\n\n## Success Criteria\n- [ ] Each tool has an act-compatible workflow mapping\n- [ ] Unsupported jobs are documented and skipped\n- [ ] Artifact paths are consistent across tools","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T14:36:52.346436490Z","created_by":"ubuntu","updated_at":"2026-01-30T14:39:31.371649452Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.2.13","depends_on_id":"bd-1jt.2","type":"parent-child","created_at":"2026-01-30T14:36:52.346436490Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.13","depends_on_id":"bd-1jt.2.4","type":"blocks","created_at":"2026-01-30T14:39:31.371618554Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.2.2","title":"Setup Linux build environment on Contabo (css)","description":"# Setup Linux Build Environment on Contabo\n\n## Purpose\nEnsure the Contabo superserver (css) has all toolchains needed to build any tool.\n\n## Host Details\n- Alias: css\n- IP: ubuntu@209.145.54.164\n- Key: ~/.ssh/contabo_new_baremetal_superserver_box.pem\n- OS: Ubuntu Linux (x86_64)\n\n## Required Toolchains\n\n### 1. Rust Nightly\n\\`\\`\\`bash\n# Install rustup if missing\ncurl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y\n\n# Install nightly toolchain\nrustup install nightly\nrustup default nightly\n\n# Install cross-compilation targets\nrustup target add x86_64-pc-windows-gnu\nrustup target add aarch64-unknown-linux-gnu\nrustup target add x86_64-unknown-linux-musl\n\n# Install cargo-zigbuild for easy cross-compilation\ncargo install cargo-zigbuild\n\\`\\`\\`\n\n### 2. Go (Latest)\n\\`\\`\\`bash\n# Download and install\nwget https://go.dev/dl/go1.23.linux-amd64.tar.gz\nsudo tar -C /usr/local -xzf go1.23.linux-amd64.tar.gz\necho 'export PATH=\\$PATH:/usr/local/go/bin' >> ~/.bashrc\n\n# Verify\ngo version\n\\`\\`\\`\n\n### 3. Bun (Latest)\n\\`\\`\\`bash\ncurl -fsSL https://bun.sh/install | bash\n\\`\\`\\`\n\n### 4. Zig (for cargo-zigbuild)\n\\`\\`\\`bash\n# cargo-zigbuild needs zig installed\nsnap install zig --classic --beta\n# or\nwget https://ziglang.org/download/0.13.0/zig-linux-x86_64-0.13.0.tar.xz\ntar xf zig-linux-x86_64-0.13.0.tar.xz\nsudo mv zig-linux-x86_64-0.13.0 /usr/local/zig\necho 'export PATH=\\$PATH:/usr/local/zig' >> ~/.bashrc\n\\`\\`\\`\n\n### 5. Build Dependencies\n\\`\\`\\`bash\nsudo apt update\nsudo apt install -y \\\\\n  build-essential \\\\\n  pkg-config \\\\\n  libssl-dev \\\\\n  mingw-w64 \\\\           # For Windows cross-compilation\n  gcc-aarch64-linux-gnu  # For ARM64 cross-compilation\n\\`\\`\\`\n\n## Verification Script\nCreate /home/ubuntu/bin/dsr-verify-toolchains.sh:\n\\`\\`\\`bash\n#!/bin/bash\necho \"=== DSR Toolchain Verification ===\"\necho -n \"Rust: \"; rustc --version || echo \"MISSING\"\necho -n \"Cargo: \"; cargo --version || echo \"MISSING\"\necho -n \"Go: \"; go version || echo \"MISSING\"\necho -n \"Bun: \"; bun --version || echo \"MISSING\"\necho -n \"Zig: \"; zig version || echo \"MISSING\"\necho -n \"MinGW: \"; x86_64-w64-mingw32-gcc --version | head -1 || echo \"MISSING\"\necho -n \"ARM64 GCC: \"; aarch64-linux-gnu-gcc --version | head -1 || echo \"MISSING\"\necho \"=== Done ===\"\n\\`\\`\\`\n\n## Success Criteria\n- [ ] All toolchains installed and in PATH\n- [ ] cargo-zigbuild can cross-compile to Windows\n- [ ] cargo-zigbuild can cross-compile to ARM64\n- [ ] Go can cross-compile to all targets\n- [ ] Bun can compile standalone binaries\n- [ ] Verification script exits 0\n\n## Maintenance\n- Add cron job to check for toolchain updates weekly\n- Document upgrade procedures for each toolchain","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:08:52.965747343Z","created_by":"ubuntu","updated_at":"2026-01-30T13:08:52.965747343Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.2.2","depends_on_id":"bd-1jt.2","type":"parent-child","created_at":"2026-01-30T13:08:52.965747343Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.2.3","title":"Setup macOS build environment on Mac mini (mmini)","description":"# Setup macOS Build Environment on Mac mini\n\n## Purpose\nEnsure the Mac mini (mmini) has all toolchains needed to build macOS binaries.\n\n## Host Details\n- Alias: mmini\n- Connection: ssh mmini (via Tailscale)\n- OS: macOS (Apple Silicon ARM64)\n- User: jemanuel\n- Sudo: Passwordless via /etc/sudoers.d/jemanuel\n\n## Required Toolchains\n\n### 1. Homebrew (Package Manager)\n\\`\\`\\`bash\n# Should already be installed, verify:\nbrew --version\n\n# If missing:\n/bin/bash -c \"\\$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n\\`\\`\\`\n\n### 2. Rust Nightly\n\\`\\`\\`bash\n# Install rustup\ncurl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y\n\n# Install nightly\nrustup install nightly\nrustup default nightly\n\n# Add x86_64 target for universal builds\nrustup target add x86_64-apple-darwin\n\\`\\`\\`\n\n### 3. Go (Latest)\n\\`\\`\\`bash\nbrew install go\n# or download from go.dev for specific version\n\\`\\`\\`\n\n### 4. Bun (Latest)\n\\`\\`\\`bash\nbrew install oven-sh/bun/bun\n# or\ncurl -fsSL https://bun.sh/install | bash\n\\`\\`\\`\n\n### 5. Xcode Command Line Tools\n\\`\\`\\`bash\nxcode-select --install\n# Needed for: clang, ar, ranlib, etc.\n\\`\\`\\`\n\n## Universal Binary Support\nmacOS can build both ARM64 and x86_64:\n\n### Rust Universal Binary\n\\`\\`\\`bash\n# Build for both architectures\ncargo build --release --target aarch64-apple-darwin\ncargo build --release --target x86_64-apple-darwin\n\n# Create universal binary with lipo\nlipo -create \\\\\n  target/aarch64-apple-darwin/release/mytool \\\\\n  target/x86_64-apple-darwin/release/mytool \\\\\n  -output mytool-universal\n\\`\\`\\`\n\n### Go Universal Binary\n\\`\\`\\`bash\n# Build ARM64\nGOARCH=arm64 go build -o mytool-arm64 ./cmd/mytool\n\n# Build x86_64\nGOARCH=amd64 go build -o mytool-amd64 ./cmd/mytool\n\n# Create universal\nlipo -create mytool-arm64 mytool-amd64 -output mytool-universal\n\\`\\`\\`\n\n## Verification Script\nCreate ~/bin/dsr-verify-toolchains.sh:\n\\`\\`\\`bash\n#!/bin/bash\necho \"=== DSR Toolchain Verification (macOS) ===\"\necho -n \"Homebrew: \"; brew --version | head -1 || echo \"MISSING\"\necho -n \"Rust: \"; rustc --version || echo \"MISSING\"\necho -n \"Cargo: \"; cargo --version || echo \"MISSING\"\necho -n \"Go: \"; go version || echo \"MISSING\"\necho -n \"Bun: \"; bun --version || echo \"MISSING\"\necho -n \"Xcode CLT: \"; xcode-select -p || echo \"MISSING\"\necho -n \"lipo: \"; which lipo || echo \"MISSING\"\necho \"=== Rust Targets ===\"\nrustup target list --installed\necho \"=== Done ===\"\n\\`\\`\\`\n\n## Success Criteria\n- [ ] All toolchains installed and in PATH\n- [ ] Rust can build for both ARM64 and x86_64\n- [ ] Go can cross-compile for both architectures\n- [ ] lipo available for creating universal binaries\n- [ ] Verification script exits 0\n\n## Notes\n- Mac mini is accessed via Tailscale, ensure daemon is running\n- Apple Silicon can run x86_64 binaries via Rosetta 2\n- Consider code signing for distribution (future enhancement)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:09:08.613890651Z","created_by":"ubuntu","updated_at":"2026-01-30T13:09:08.613890651Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.2.3","depends_on_id":"bd-1jt.2","type":"parent-child","created_at":"2026-01-30T13:09:08.613890651Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.2.4","title":"CRITICAL: Use nektos/act to run GH Actions YAML locally","description":"# Use nektos/act to Run GH Actions Workflows Locally\n\n## Purpose\nReuse existing `.github/workflows/*.yml` to build releases locally when GH Actions is throttled.\n\n## Key `act` Capabilities (from official docs)\n- Run a specific workflow: `act -W .github/workflows/release.yml`\n- Run a specific job: `act -j build-linux`\n- List jobs: `act -l`\n- Override runner images: `-P ubuntu-latest=...`\n- Set container architecture: `--container-architecture linux/arm64`\n- Control pulls / offline mode: `--pull=false` / `--action-offline-mode`\n- Route artifacts: `--artifact-server-path /tmp/act-artifacts`\n\n## Critical Limitations\n- `act` runs workflows in **Docker** (Linux). It **cannot** execute macOS/Windows runner jobs.\n- macOS/Windows builds must be native (mmini, wlap) or cross-compiled.\n\n## Success Criteria\n- [ ] `act` runs `release.yml` for Linux targets\n- [ ] Runner images pinned via `~/.actrc`\n- [ ] Artifact collection path standardized\n- [ ] Offline mode works once images are cached\n\n## References\n- https://github.com/nektos/act\n- https://nektosact.com/usage/runners.html","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-30T13:13:00.354935621Z","created_by":"ubuntu","updated_at":"2026-01-30T15:10:09.757102675Z","closed_at":"2026-01-30T15:10:09.757085242Z","close_reason":"Created docs/ACT_SETUP.md, config/actrc.example, src/act_runner.sh with platform routing logic, and tests. Act integration ready for Linux builds.","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.2.4","depends_on_id":"bd-1jt.2","type":"parent-child","created_at":"2026-01-30T13:13:00.354935621Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.2.5","title":"Install and configure act on build hosts (css, mmini)","description":"# Install and Configure act on Build Hosts\n\n## Purpose\nInstall nektos/act on both Contabo (css) and Mac mini (mmini) so we can run GH Actions workflows locally.\n\n## Contabo (css) - Linux\n\n### Installation\n\\`\\`\\`bash\nssh css\n\n# Install act via official script\ncurl -s https://raw.githubusercontent.com/nektos/act/master/install.sh | sudo bash\n\n# Verify\nact --version\n\\`\\`\\`\n\n### Docker Setup\nact requires Docker:\n\\`\\`\\`bash\n# Should already be installed, verify:\ndocker --version\ndocker run hello-world\n\n# If not installed:\ncurl -fsSL https://get.docker.com | sudo sh\nsudo usermod -aG docker ubuntu\n\\`\\`\\`\n\n### Pull Runner Images\n\\`\\`\\`bash\n# Pull medium image (recommended)\ndocker pull catthehacker/ubuntu:act-latest\ndocker pull catthehacker/ubuntu:act-22.04\n\n# Pre-pull Rust build images\ndocker pull rust:latest\ndocker pull rust:nightly\n\\`\\`\\`\n\n### Configure act\nCreate ~/.actrc:\n\\`\\`\\`\n-P ubuntu-latest=catthehacker/ubuntu:act-latest\n-P ubuntu-22.04=catthehacker/ubuntu:act-22.04\n--artifact-server-path /tmp/act-artifacts\n\\`\\`\\`\n\n## Mac mini (mmini) - macOS\n\n### Installation\n\\`\\`\\`bash\nssh mmini\n\n# Install via Homebrew\nbrew install act\n\n# Verify\nact --version\n\\`\\`\\`\n\n### Docker Setup (Colima or Docker Desktop)\n\\`\\`\\`bash\n# Option A: Colima (lighter weight)\nbrew install colima docker\ncolima start --cpu 4 --memory 8\n\n# Option B: Docker Desktop (if already installed)\nopen -a Docker\n\\`\\`\\`\n\n### Pull Runner Images\n\\`\\`\\`bash\n# Pull ARM64 images\ndocker pull catthehacker/ubuntu:act-latest\n\\`\\`\\`\n\n### Configure act\nCreate ~/.actrc:\n\\`\\`\\`\n-P ubuntu-latest=catthehacker/ubuntu:act-latest\n--container-architecture linux/arm64\n--artifact-server-path /tmp/act-artifacts\n\\`\\`\\`\n\n## Verification Script\n\nCreate dsr-verify-act.sh on each host:\n\\`\\`\\`bash\n#!/bin/bash\necho \"=== act Verification ===\"\necho -n \"act version: \"; act --version || echo \"MISSING\"\necho -n \"Docker: \"; docker --version || echo \"MISSING\"\necho \"Runner images:\"\ndocker images | grep -E \"catthehacker|ubuntu\"\necho \"Test run:\"\ncd /tmp && mkdir -p test-act && cd test-act\nmkdir -p .github/workflows\ncat > .github/workflows/test.yml << 'WFEOF'\nname: Test\non: push\njobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - run: echo \"act works!\"\nWFEOF\nact -l\necho \"=== Done ===\"\n\\`\\`\\`\n\n## Success Criteria\n- [ ] act installed on css\n- [ ] act installed on mmini  \n- [ ] Docker working on both hosts\n- [ ] Runner images pulled\n- [ ] Test workflow runs successfully\n- [ ] Artifact collection works","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:13:36.120915334Z","created_by":"ubuntu","updated_at":"2026-01-30T13:15:29.576008238Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.2.5","depends_on_id":"bd-1jt.2","type":"parent-child","created_at":"2026-01-30T13:13:36.120915334Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.5","depends_on_id":"bd-1jt.2.4","type":"blocks","created_at":"2026-01-30T13:15:29.575978792Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.2.6","title":"Hybrid build strategy: act + SSH for cross-platform","description":"# Hybrid Build Strategy: act + Native Hosts\n\n## Purpose\nCombine `act` (Linux builds) with native macOS + Windows hosts for reliable cross-platform artifacts.\n\n## Why Hybrid\n- `act` reuses GH Actions workflows but runs **Linux** containers only\n- macOS/Windows require native hosts (mmini, wlap)\n\n## Build Orchestration (Pseudo)\n```bash\ndsr_build_all_platforms() {\n  local tool=\"$1\" version=\"$2\"\n\n  # Start Linux builds via act on css\n  if output=$(ssh css \"cd /data/projects/$tool && act -W .github/workflows/release.yml\" 2>&1); then\n    log info \"Linux builds OK\"\n  else\n    log error \"Linux builds failed\"; return 1\n  fi\n\n  # macOS builds on mmini (native)\n  if output=$(ssh mmini \"cd /data/projects/$tool && ./scripts/build-macos.sh $version\" 2>&1); then\n    log info \"macOS builds OK\"\n  else\n    log warn \"macOS builds failed\"; macos_failed=1\n  fi\n\n  # Windows builds on wlap (native)\n  if output=$(ssh wlap \"cd C:\\\\projects\\\\$tool && scripts\\\\build-windows.bat $version\" 2>&1); then\n    log info \"Windows builds OK\"\n  else\n    log warn \"Windows builds failed\"; win_failed=1\n  fi\n\n  # Handle partial failures explicitly (no set -e)\n  [ \"${macos_failed:-0}\" -eq 0 ] && [ \"${win_failed:-0}\" -eq 0 ]\n}\n```\n\n## Success Criteria\n- [ ] Linux builds via `act` on css\n- [ ] macOS builds via mmini\n- [ ] Windows builds via wlap\n- [ ] Partial failures reported clearly (no silent exits)","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-30T13:14:47.033880170Z","created_by":"ubuntu","updated_at":"2026-01-30T14:39:36.739121104Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.2.6","depends_on_id":"bd-1jt.2","type":"parent-child","created_at":"2026-01-30T13:14:47.033880170Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.6","depends_on_id":"bd-1jt.2.13","type":"blocks","created_at":"2026-01-30T14:39:36.739089034Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.2.7","title":"Setup Windows build environment on Windows laptop (wlap)","description":"# Setup Windows Build Environment on Windows Laptop\n\n## Purpose\nEnable native Windows builds via SSH to a Windows laptop, avoiding cross-compilation limitations and ensuring native binary quality.\n\n## Why Native Windows Builds?\n\nCross-compilation from Linux has limitations:\n- Rust: cargo-zigbuild works but can miss Windows-specific optimizations\n- Go: Cross-compile works well but some CGO dependencies fail\n- Bun: Limited cross-compile support\n\nNative Windows builds provide:\n- Proper Windows SDK integration\n- Native MSVC optimizations\n- Accurate testing environment\n- Full Windows-specific feature support\n\n## Prerequisites on Windows Laptop\n\n### 1. Enable SSH Server\n\\`\\`\\`powershell\n# Run as Administrator\nAdd-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0\nStart-Service sshd\nSet-Service -Name sshd -StartupType 'Automatic'\n\n# Allow through firewall\nNew-NetFirewallRule -Name 'SSH' -DisplayName 'OpenSSH Server' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22\n\\`\\`\\`\n\n### 2. Configure SSH Key Auth\n\\`\\`\\`powershell\n# Create .ssh directory\nmkdir ~\\.ssh\n\n# Add authorized keys (copy from css)\nnotepad ~\\.ssh\\authorized_keys\n# Paste the public key from css\n\\`\\`\\`\n\n### 3. Install Build Toolchains\n\n#### Rust\n\\`\\`\\`powershell\n# Download and run rustup-init.exe\nInvoke-WebRequest -Uri https://win.rustup.rs -OutFile rustup-init.exe\n.\\rustup-init.exe -y --default-toolchain nightly\n# Restart shell\n\\`\\`\\`\n\n#### Go\n\\`\\`\\`powershell\n# Download from go.dev or use winget\nwinget install GoLang.Go\n# Or chocolatey\nchoco install golang\n\\`\\`\\`\n\n#### Bun\n\\`\\`\\`powershell\npowershell -c \"irm bun.sh/install.ps1 | iex\"\n\\`\\`\\`\n\n#### Visual Studio Build Tools (for Rust MSVC)\n\\`\\`\\`powershell\n# Download Visual Studio Build Tools\nwinget install Microsoft.VisualStudio.2022.BuildTools\n# Select \"Desktop development with C++\" workload\n\\`\\`\\`\n\n## SSH Configuration on css/mmini\n\nAdd to ~/.ssh/config:\n\\`\\`\\`\nHost wlap\n    HostName <windows-laptop-ip>\n    User <username>\n    IdentityFile ~/.ssh/wlap_ed25519\n    # May need PowerShell as default shell\n    # RemoteCommand powershell.exe\n\\`\\`\\`\n\nGenerate key:\n\\`\\`\\`bash\nssh-keygen -t ed25519 -f ~/.ssh/wlap_ed25519 -N \"\"\nssh-copy-id -i ~/.ssh/wlap_ed25519 wlap\n\\`\\`\\`\n\n## Build Commands via SSH\n\n### Rust\n\\`\\`\\`bash\nssh wlap \"cd C:\\projects\\cass && cargo build --release\"\nscp wlap:C:\\projects\\cass\\target\\release\\cass.exe ./builds/\n\\`\\`\\`\n\n### Go\n\\`\\`\\`bash\nssh wlap \"cd C:\\projects\\ntm && go build -o ntm.exe ./cmd/ntm\"\nscp wlap:C:\\projects\\ntm\\ntm.exe ./builds/\n\\`\\`\\`\n\n## Updated Build Matrix\n\n| Target | Host | Method |\n|--------|------|--------|\n| linux-amd64 | css | native |\n| linux-arm64 | css | cross-compile |\n| darwin-arm64 | mmini | native |\n| darwin-amd64 | mmini | native |\n| windows-amd64 | wlap | native |\n\n## Verification Script\n\\`\\`\\`powershell\n# C:\\bin\\dsr-verify-toolchains.ps1\nWrite-Host \"=== DSR Toolchain Verification (Windows) ===\"\nWrite-Host \"Rust: \" -NoNewline; rustc --version\nWrite-Host \"Cargo: \" -NoNewline; cargo --version\nWrite-Host \"Go: \" -NoNewline; go version\nWrite-Host \"Bun: \" -NoNewline; bun --version\nWrite-Host \"MSVC: \" -NoNewline; cl 2>&1 | Select-String \"Version\"\nWrite-Host \"=== Done ===\"\n\\`\\`\\`\n\n## Networking Considerations\n- If laptop is on different network, may need VPN or Tailscale\n- Consider Tailscale for consistent IP across networks\n- Test SSH from css before relying on it\n\n## Success Criteria\n- [ ] SSH from css to wlap works\n- [ ] Rust builds produce valid .exe\n- [ ] Go builds produce valid .exe\n- [ ] File transfer (scp) works\n- [ ] Verification script passes","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:16:39.813118424Z","created_by":"ubuntu","updated_at":"2026-01-30T13:16:39.813118424Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.2.7","depends_on_id":"bd-1jt.2","type":"parent-child","created_at":"2026-01-30T13:16:39.813118424Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.2.8","title":"Implement host health checking before builds","description":"# Host Health Checking Before Builds\n\n## Purpose\nBefore attempting builds on remote hosts (css, mmini, wlap), verify they are accessible and have required resources. Fail fast with clear errors rather than hanging on SSH timeouts.\n\n## Why This Matters\n- SSH can hang for minutes on unreachable hosts\n- Builds may fail late due to disk space or missing toolchains\n- Parallel builds need all hosts ready before starting\n\n## Command Interface\n\\`\\`\\`bash\ndsr hosts check              # Check all configured hosts\ndsr hosts check css mmini    # Check specific hosts\ndsr hosts check --json       # Machine-readable output\ndsr hosts status             # Show last-known status\n\\`\\`\\`\n\n## Health Checks Per Host\n\n### 1. Connectivity (SSH)\n\\`\\`\\`bash\ncheck_ssh() {\n  local host=\"\\$1\"\n  ssh -o ConnectTimeout=5 -o BatchMode=yes \"\\$host\" \"echo ok\" 2>/dev/null\n}\n\\`\\`\\`\n\n### 2. Disk Space\n\\`\\`\\`bash\ncheck_disk() {\n  local host=\"\\$1\"\n  local min_gb=\"\\${2:-5}\"\n  local avail=\\$(ssh \"\\$host\" \"df -BG /tmp | tail -1 | awk '{print \\$4}' | tr -d 'G'\")\n  [ \"\\$avail\" -ge \"\\$min_gb\" ]\n}\n\\`\\`\\`\n\n### 3. Toolchain Availability\n\\`\\`\\`bash\ncheck_toolchains() {\n  local host=\"\\$1\"\n  local lang=\"\\$2\"\n  \n  case \"\\$lang\" in\n    rust) ssh \"\\$host\" \"cargo --version\" ;;\n    go)   ssh \"\\$host\" \"go version\" ;;\n    bun)  ssh \"\\$host\" \"bun --version\" ;;\n  esac\n}\n\\`\\`\\`\n\n### 4. Docker (for act)\n\\`\\`\\`bash\ncheck_docker() {\n  local host=\"\\$1\"\n  ssh \"\\$host\" \"docker info --format '{{.ServerVersion}}'\" 2>/dev/null\n}\n\\`\\`\\`\n\n## Output Format (JSON)\n\\`\\`\\`json\n{\n  \"timestamp\": \"2026-01-30T13:20:00Z\",\n  \"hosts\": {\n    \"css\": {\n      \"status\": \"healthy\",\n      \"ssh\": true,\n      \"disk_gb\": 150,\n      \"toolchains\": {\"rust\": \"1.76.0-nightly\", \"go\": \"1.23.4\"},\n      \"docker\": \"24.0.7\",\n      \"latency_ms\": 45\n    },\n    \"mmini\": {\n      \"status\": \"degraded\",\n      \"ssh\": true,\n      \"disk_gb\": 8,\n      \"toolchains\": {\"rust\": \"1.76.0-nightly\", \"go\": \"1.23.4\"},\n      \"docker\": null,\n      \"latency_ms\": 120,\n      \"warnings\": [\"Low disk space (8GB < 10GB threshold)\"]\n    },\n    \"wlap\": {\n      \"status\": \"offline\",\n      \"ssh\": false,\n      \"error\": \"Connection timed out\"\n    }\n  }\n}\n\\`\\`\\`\n\n## Integration with dsr build\n\\`\\`\\`bash\ndsr_build() {\n  # Pre-flight check\n  log \"Checking build hosts...\"\n  local health=\\$(dsr hosts check --json)\n  \n  local offline=\\$(echo \"\\$health\" | jq -r '.hosts | to_entries[] | select(.value.status == \"offline\") | .key')\n  if [ -n \"\\$offline\" ]; then\n    warn \"Offline hosts: \\$offline\"\n    warn \"Some targets may not build\"\n  fi\n  \n  # Proceed with healthy hosts only\n  for host in \\$(echo \"\\$health\" | jq -r '.hosts | to_entries[] | select(.value.status != \"offline\") | .key'); do\n    build_on_host \"\\$host\" &\n  done\n}\n\\`\\`\\`\n\n## Caching\n- Cache health status for 5 minutes\n- Force refresh with --no-cache\n- Background refresh during long operations\n\n## Success Criteria\n- [ ] SSH check completes in <10 seconds per host\n- [ ] Disk space threshold configurable\n- [ ] Toolchain checks work for all languages\n- [ ] Clear error messages for offline hosts\n- [ ] JSON output parseable by jq\n- [ ] Graceful degradation (build what we can)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:23:11.872176622Z","created_by":"ubuntu","updated_at":"2026-01-30T13:23:11.872176622Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.2.8","depends_on_id":"bd-1jt.2","type":"parent-child","created_at":"2026-01-30T13:23:11.872176622Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.2.9","title":"Implement retry and recovery logic for failed builds","description":"# Retry and Recovery Logic\n\n## Purpose\nHandle transient failures gracefully. Network hiccups, disk space issues, and SSH timeouts should not require manual intervention.\n\n## Retry Strategies\n\n### Exponential Backoff\n```bash\nretry_with_backoff() {\n  local max_attempts=5\n  local attempt=1\n  local delay=5\n  \n  while [ $attempt -le $max_attempts ]; do\n    if \"$@\"; then\n      return 0\n    fi\n    \n    log \"Attempt $attempt failed, retrying in ${delay}s...\"\n    sleep $delay\n    attempt=$((attempt + 1))\n    delay=$((delay * 2))  # 5, 10, 20, 40, 80 seconds\n  done\n  \n  return 1\n}\n```\n\n### Idempotent Operations\nAll build operations are idempotent:\n- Re-running a build produces same artifacts\n- Partial uploads can be resumed\n- Failed hosts don't block successful ones\n\n### State Tracking\n```bash\n# .dsr/state/<tool>-<version>.json\n{\n  \"started_at\": \"2026-01-30T13:00:00Z\",\n  \"hosts\": {\n    \"css\": { \"status\": \"complete\", \"artifacts\": [...] },\n    \"mmini\": { \"status\": \"failed\", \"error\": \"SSH timeout\", \"retries\": 2 },\n    \"wlap\": { \"status\": \"pending\" }\n  },\n  \"release\": { \"status\": \"pending\" }\n}\n```\n\n### Resume Failed Builds\n```bash\ndsr build ntm v1.5.2 --resume  # Picks up where it left off\n```\n\n## Recovery Actions\n| Error | Action |\n|-------|--------|\n| SSH timeout | Retry with longer timeout |\n| Disk full | Clean old builds, retry |\n| Network error | Retry with backoff |\n| Build failure | Log error, skip host |\n| All hosts fail | Notify user, abort |\n\n## Success Criteria\n- [ ] Transient failures auto-recover\n- [ ] State tracked persistently\n- [ ] --resume works correctly\n- [ ] Partial builds don't block release\n- [ ] Clear error reporting","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:29:53.592266937Z","created_by":"ubuntu","updated_at":"2026-01-30T14:39:16.822582426Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.2.9","depends_on_id":"bd-1jt.2","type":"parent-child","created_at":"2026-01-30T13:29:53.592266937Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.9","depends_on_id":"bd-1jt.2.1","type":"blocks","created_at":"2026-01-30T13:30:48.971484244Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.2.9","depends_on_id":"bd-1jt.2.11","type":"blocks","created_at":"2026-01-30T14:39:16.822551477Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.3","title":"Theme 3: Release Upload Automation","description":"# Release Upload Automation\n\n## Purpose\nAfter local builds complete, create GitHub releases and upload binaries with proper checksums and signatures.\n\n## The dsr release Command\n\\`\\`\\`bash\ndsr release <tool> <version>           # Create release, upload all builds\ndsr release <tool> <version> --draft   # Create as draft first\ndsr release <tool> <version> --notes \"...\" # Custom release notes\n\\`\\`\\`\n\n## Release Workflow\n\n### 1. Verify Builds Exist\n\\`\\`\\`bash\n# Check all expected artifacts exist\nfor target in linux-amd64 linux-arm64 darwin-arm64 darwin-amd64 windows-amd64; do\n  artifact=\"./builds/\\${tool}-\\${version}-\\${target}\"\n  [ -f \"\\$artifact\" ] || die \"Missing: \\$artifact\"\ndone\n\\`\\`\\`\n\n### 2. Generate Checksums\n\\`\\`\\`bash\ncd ./builds\nsha256sum \\${tool}-\\${version}-* > \\${tool}-\\${version}-checksums.sha256\n\\`\\`\\`\n\n### 3. Sign Artifacts (Optional but Recommended)\n\\`\\`\\`bash\n# Using minisign\nfor f in \\${tool}-\\${version}-*; do\n  minisign -Sm \"\\$f\" -s ~/.minisign/key.sec\ndone\n\\`\\`\\`\n\n### 4. Create GitHub Release\n\\`\\`\\`bash\ngh release create \"\\$version\" \\\\\n  --repo \"Dicklesworthstone/\\$tool\" \\\\\n  --title \"\\$tool \\$version\" \\\\\n  --notes \"\\$release_notes\" \\\\\n  ./builds/\\${tool}-\\${version}-*\n\\`\\`\\`\n\n### 5. Verify Upload\n\\`\\`\\`bash\ngh release view \"\\$version\" --repo \"Dicklesworthstone/\\$tool\" --json assets\n\\`\\`\\`\n\n## Release Notes Generation\nAuto-generate from git log since last release:\n\\`\\`\\`bash\nlast_tag=\\$(git describe --tags --abbrev=0 HEAD^)\ngit log --oneline \\${last_tag}..HEAD > release_notes.txt\n\\`\\`\\`\n\n## Asset Naming Convention\n\\`\\`\\`\n{tool}-{version}-{os}-{arch}[.exe]\n{tool}-{version}-checksums.sha256\n{tool}-{version}-{os}-{arch}.minisig\n\\`\\`\\`\n\nExamples:\n\\`\\`\\`\nntm-v1.5.1-linux-amd64\nntm-v1.5.1-darwin-arm64\nntm-v1.5.1-windows-amd64.exe\nntm-v1.5.1-checksums.sha256\n\\`\\`\\`\n\n## Success Criteria\n- [ ] Creates release with correct tag\n- [ ] All binaries uploaded and downloadable\n- [ ] Checksums file included\n- [ ] Release notes auto-generated if not provided\n- [ ] Works for all 16 tools\n\n## Error Handling\n- Release already exists → Prompt to update or abort\n- Upload fails → Retry, then report which assets failed\n- Tag doesn't exist → Create tag or error","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:09:26.299668699Z","created_by":"ubuntu","updated_at":"2026-01-30T13:09:26.299668699Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.3","depends_on_id":"bd-1jt","type":"parent-child","created_at":"2026-01-30T13:09:26.299668699Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.3.1","title":"Implement dsr release command - upload artifacts to GitHub","description":"# Implement `dsr release` — Upload Artifacts to GitHub\n\n## Purpose\nCreate a GitHub Release from locally built artifacts, with retries, verification, and consistent metadata.\n\n## Command Interface\n```bash\ndsr release <tool> <version>\ndsr release <tool> <version> --artifacts <dir>\ndsr release <tool> <version> --draft\n dsr release <tool> <version> --generate-notes\n dsr release <tool> <version> --notes-from-tag <tag>\n dsr release <tool> <version> --verify-tag\n dsr release <tool> <version> --dry-run\n```\n\n## Implementation Notes (gh CLI)\n- Use `gh release create` with:\n  - `--verify-tag` to ensure tag exists\n  - `--generate-notes` or `--notes-from-tag` for changelog\n- Use `gh release upload --clobber` to retry failed assets\n- Verify assets via `gh release view --json assets`\n\n## Error Handling\n- Release exists → prompt to update, abort, or replace\n- Missing artifacts → list expected vs actual\n- Partial upload → retry only failed assets\n\n## Success Criteria\n- [ ] Release created with correct tag & notes\n- [ ] All binaries + checksums uploaded\n- [ ] Upload verification passes\n- [ ] Works across all 16 tools","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:13:53.575381627Z","created_by":"ubuntu","updated_at":"2026-01-30T14:39:52.882521574Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.3.1","depends_on_id":"bd-1jt.1.8","type":"blocks","created_at":"2026-01-30T14:39:02.228966845Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.1","depends_on_id":"bd-1jt.2.1","type":"blocks","created_at":"2026-01-30T13:15:41.414912067Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.1","depends_on_id":"bd-1jt.2.12","type":"blocks","created_at":"2026-01-30T14:39:22.386430911Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.1","depends_on_id":"bd-1jt.3","type":"parent-child","created_at":"2026-01-30T13:13:53.575381627Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.1","depends_on_id":"bd-1jt.3.11","type":"blocks","created_at":"2026-01-30T14:39:52.882491227Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.1","depends_on_id":"bd-1jt.3.3","type":"blocks","created_at":"2026-01-30T13:26:54.944683486Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.1","depends_on_id":"bd-1jt.7.1","type":"blocks","created_at":"2026-01-30T14:38:53.751889231Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.3.10","title":"Implement release verification + retry/resume uploads","description":"# Implement Release Verification + Retry/Resume Uploads\n\n## Purpose\nEnsure GitHub releases contain the exact expected assets, and recover safely from partial upload failures.\n\n## Verification Steps\n- Compare release assets against build manifest\n- Verify checksums.sha256 matches uploaded binaries\n- Optionally re-download and verify sha256 for spot checks\n\n## Retry Strategy\n- Use gh release upload --clobber for failed assets\n- Track failed uploads in state file for resume\n\n## Success Criteria\n- [ ] Missing assets detected and reported\n- [ ] Partial uploads can be resumed safely\n- [ ] Release verification produces JSON report","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T14:36:58.956655125Z","created_by":"ubuntu","updated_at":"2026-01-30T14:39:40.580812368Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.3.10","depends_on_id":"bd-1jt.1.9","type":"blocks","created_at":"2026-01-30T14:39:12.415821448Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.10","depends_on_id":"bd-1jt.2.12","type":"blocks","created_at":"2026-01-30T14:39:22.651659081Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.10","depends_on_id":"bd-1jt.3","type":"parent-child","created_at":"2026-01-30T14:36:58.956655125Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.10","depends_on_id":"bd-1jt.3.1","type":"blocks","created_at":"2026-01-30T14:39:40.580783022Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.3.11","title":"Add pre-release quality gates (typecheck/lint/test) per tool","description":"# Add Pre-Release Quality Gates (typecheck/lint/test) Per Tool\n\n## Purpose\nAvoid releasing broken builds by running lightweight validation commands before build/release.\n\n## Configuration\nIn repos.yaml per tool:\n- check_cmds: list of commands (typecheck, lint, unit tests)\n- allow_fail: optional list for non-blocking checks\n\n## Behavior\n- Run checks before dsr build/release (unless --skip-checks)\n- Fail fast for blocking checks\n- Capture logs to state dir\n\n## Success Criteria\n- [ ] Configurable per tool\n- [ ] Supports --skip-checks\n- [ ] Clear JSON report of pass/fail","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T14:37:06.086111454Z","created_by":"ubuntu","updated_at":"2026-01-30T14:39:47.402968576Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.3.11","depends_on_id":"bd-1jt.1.8","type":"blocks","created_at":"2026-01-30T14:39:47.402939311Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.11","depends_on_id":"bd-1jt.3","type":"parent-child","created_at":"2026-01-30T14:37:06.086111454Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.3.2","title":"Update Homebrew and Scoop formulas after release","description":"# Update Homebrew and Scoop Formulas After Release\n\n## Purpose\nUpdate package manager metadata so users can install via `brew` and `scoop` with correct URLs + SHA256.\n\n## Homebrew (Formula Cookbook)\n- Formula requires `url`, `sha256`, and `version`\n- Prefer `brew bump-formula-pr` or consistent commit formatting\n- Validate with `brew audit --strict`\n\n## Scoop Manifest (Scoop Installer Docs)\n- `version`, `architecture`, `url`, and `hash` are required\n- `hash` uses `sha256:<hex>` format\n\n## Success Criteria\n- [ ] Homebrew formula updated with new URL + SHA256\n- [ ] Scoop manifest updated with new URL + hash\n- [ ] Changes verified in CI or local install test\n\n## References\n- https://docs.brew.sh/Formula-Cookbook\n- https://github.com/ScoopInstaller/Scoop/wiki/App-Manifests","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:23:34.632986314Z","created_by":"ubuntu","updated_at":"2026-01-30T14:35:12.260132997Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.3.2","depends_on_id":"bd-1jt.3","type":"parent-child","created_at":"2026-01-30T13:23:34.632986314Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.2","depends_on_id":"bd-1jt.3.1","type":"blocks","created_at":"2026-01-30T13:26:56.108363071Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.3.3","title":"Implement minisign artifact signing","description":"# Implement Minisign Artifact Signing\n\n## Purpose\nSign every release artifact so users can verify authenticity.\n\n## Signing Commands (Minisign)\n```bash\n# Sign\nminisign -Sm <file> -s ~/.config/dsr/secrets/minisign.key -t \"<tool> <version>\"\n\n# Verify\nminisign -Vm <file> -P \"<PUBLIC_KEY>\"\n```\n\n## Release Assets\n- `<binary>.minisig` for every binary\n- `checksums.sha256.minisig` for checksum file\n\n## Installer Verification\n- If `minisign` is present → verify by default\n- If missing → warn + continue (unless `--require-signatures`)\n\n## Success Criteria\n- [ ] All binaries are signed\n- [ ] Signatures are uploaded to releases\n- [ ] Installers can verify signatures\n- [ ] Signing uses password-protected key\n\n## References\n- https://jedisct1.github.io/minisign/","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:23:59.730105373Z","created_by":"ubuntu","updated_at":"2026-01-30T14:35:28.589761719Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.3.3","depends_on_id":"bd-1jt.3","type":"parent-child","created_at":"2026-01-30T13:23:59.730105373Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.3","depends_on_id":"bd-1jt.3.9","type":"blocks","created_at":"2026-01-30T14:24:03.620154033Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.3.4","title":"Generate SBOM (Software Bill of Materials) for releases","description":"# Generate SBOM (Software Bill of Materials) for Releases\n\n## Purpose\nProduce SBOMs for each release to improve supply-chain transparency.\n\n## Tooling (Syft)\n- SPDX JSON: `-o spdx-json`\n- CycloneDX JSON: `-o cyclonedx-json`\n\n```bash\nsyft dir:. -o spdx-json > dist/sbom.spdx.json\nsyft dir:. -o cyclonedx-json > dist/sbom.cdx.json\n```\n\n## Success Criteria\n- [ ] SBOM generated for each release\n- [ ] SBOMs uploaded as release assets\n- [ ] Works across Rust/Go/Bun projects\n\n## References\n- https://github.com/anchore/syft#output-formats","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T13:28:31.491498168Z","created_by":"ubuntu","updated_at":"2026-01-30T14:35:35.057550392Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.3.4","depends_on_id":"bd-1jt.2.1","type":"blocks","created_at":"2026-01-30T13:30:47.963689719Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.4","depends_on_id":"bd-1jt.3","type":"parent-child","created_at":"2026-01-30T13:28:31.491498168Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.3.5","title":"Implement checksum auto-sync across flywheel repos","description":"# Checksum Auto-Sync\n\n## Purpose\nAutomatically update checksums in agentic_coding_flywheel_setup when upstream install.sh files change. Replicates checksum-monitor.yml functionality.\n\n## How It Works\n1. When dsr releases a new version, trigger checksum recalculation\n2. Distinguish trusted (Dicklesworthstone) vs external tools\n3. Auto-commit updated checksums.yaml\n4. Create security issue for external tool changes\n\n## Implementation\n```bash\ndsr checksums update              # Recalculate all\ndsr checksums verify              # Check against upstream\ndsr checksums sync --auto-commit  # Update and commit\n```\n\n## Trusted vs External Classification\n- Trusted: Dicklesworthstone/* repos (auto-approve updates)\n- External: ohmyzsh, rustup, bun, etc. (flag for review)\n\n## Integration\n- Triggered by dsr release command\n- Dispatches repository_dispatch to agentic_coding_flywheel_setup\n- Mirrors checksum-monitor.yml workflow\n\n## Success Criteria\n- [ ] Checksums recalculated after each release\n- [ ] Security issues created for external changes\n- [ ] Auto-commit to agentic_coding_flywheel_setup\n- [ ] JSON output for --verify","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:28:44.275881995Z","created_by":"ubuntu","updated_at":"2026-01-30T13:30:48.145205991Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.3.5","depends_on_id":"bd-1jt.3","type":"parent-child","created_at":"2026-01-30T13:28:44.275881995Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.5","depends_on_id":"bd-1jt.3.1","type":"blocks","created_at":"2026-01-30T13:30:48.145176916Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.3.6","title":"Implement SLSA provenance attestation for supply chain security","description":"# Implement SLSA Provenance Attestation\n\n## Purpose\nGenerate SLSA v1 provenance (in-toto Statement + predicate) for release artifacts.\n\n## Required Structure\n- in-toto Statement v1\n- predicateType: https://slsa.dev/provenance/v1\n- subject digests reference artifact SHA256\n\n## Implementation Sketch\nCreate a provenance.json containing:\n- _type: https://in-toto.io/Statement/v1\n- subject: list of artifacts with sha256 digests\n- predicateType: https://slsa.dev/provenance/v1\n- predicate: buildDefinition + runDetails\n\n## Success Criteria\n- [ ] Provenance generated for each artifact set\n- [ ] Attached to GitHub release as asset\n- [ ] Verifiable with standard SLSA tooling\n\n## References\n- https://slsa.dev/spec/v1.0/provenance","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T13:29:38.736005543Z","created_by":"ubuntu","updated_at":"2026-01-30T14:36:08.177783356Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.3.6","depends_on_id":"bd-1jt.2.1","type":"blocks","created_at":"2026-01-30T13:30:48.805508188Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.6","depends_on_id":"bd-1jt.3","type":"parent-child","created_at":"2026-01-30T13:29:38.736005543Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.3.7","title":"Implement repository dispatch for cross-repo coordination","description":"# Repository Dispatch Coordination\n\n## Purpose\nTrigger automated workflows in other repos after dsr events. Mirrors notify-acfs.yml and checksum-monitor.yml patterns.\n\n## Use Cases\n1. After release → trigger checksum update in agentic_coding_flywheel_setup\n2. After release → trigger formula update in homebrew-tap\n3. After release → trigger manifest update in scoop-bucket\n4. After release → trigger canary tests\n\n## Implementation\n```bash\ndispatch_event() {\n  local repo=\"$1\"\n  local event=\"$2\"\n  local payload=\"$3\"\n  \n  gh api -X POST /repos/Dicklesworthstone/$repo/dispatches \\\n    -f event_type=\"$event\" \\\n    -f client_payload=\"$payload\"\n}\n\n# After successful release\nnotify_downstream() {\n  local tool=\"$1\"\n  local version=\"$2\"\n  local sha=\"$3\"\n  \n  # Notify ACFS to update checksums\n  dispatch_event \"agentic_coding_flywheel_setup\" \"upstream-changed\" \"{\n    \\\"tool\\\": \\\"$tool\\\",\n    \\\"version\\\": \\\"$version\\\",\n    \\\"sha\\\": \\\"$sha\\\",\n    \\\"source\\\": \\\"dsr\\\"\n  }\"\n  \n  # Notify homebrew-tap\n  dispatch_event \"homebrew-tap\" \"formula-update\" \"{\n    \\\"tool\\\": \\\"$tool\\\",\n    \\\"version\\\": \\\"$version\\\"\n  }\"\n  \n  # Notify scoop-bucket  \n  dispatch_event \"scoop-bucket\" \"manifest-update\" \"{\n    \\\"tool\\\": \\\"$tool\\\",\n    \\\"version\\\": \\\"$version\\\"\n  }\"\n}\n```\n\n## Required Tokens\n- GITHUB_TOKEN (for dispatching events)\n- Fine-grained PAT with contents:write on target repos\n\n## dsr Command\n```bash\ndsr dispatch <repo> <event> [--payload JSON]\ndsr dispatch --release <tool> <version>  # Triggers all downstream\n```\n\n## Success Criteria\n- [ ] Dispatches work to all target repos\n- [ ] Tokens configured securely\n- [ ] Payload includes necessary context\n- [ ] Logs all dispatched events","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T13:30:07.721230129Z","created_by":"ubuntu","updated_at":"2026-01-30T13:30:49.136265188Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.3.7","depends_on_id":"bd-1jt.3","type":"parent-child","created_at":"2026-01-30T13:30:07.721230129Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.7","depends_on_id":"bd-1jt.3.1","type":"blocks","created_at":"2026-01-30T13:30:49.136236393Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.3.8","title":"Build multi-arch Docker images for containerized tools","description":"# Multi-Arch Docker Images\n\n## Purpose\nBuild and publish multi-architecture Docker images (amd64/arm64) for tools that support containerization. Mirrors ntm release.yml docker job.\n\n## Which Tools Get Containers\nNot all tools need Docker images, but these do:\n- ubs (Ultimate Bug Scanner) - CI/CD integration\n- mcp_agent_mail - Server deployment\n- process_triage (pt) - System administration\n\n## Implementation\n```bash\nbuild_docker() {\n  local tool=\"$1\"\n  local version=\"$2\"\n  local registry=\"ghcr.io/dicklesworthstone\"\n  \n  # Check for Dockerfile\n  if [ ! -f \"/data/projects/$tool/Dockerfile\" ]; then\n    log \"No Dockerfile for $tool, skipping container build\"\n    return 0\n  fi\n  \n  cd \"/data/projects/$tool\"\n  \n  # Build multi-arch with buildx\n  docker buildx build \\\n    --platform linux/amd64,linux/arm64 \\\n    --tag \"$registry/$tool:$version\" \\\n    --tag \"$registry/$tool:latest\" \\\n    --push \\\n    --provenance=true \\\n    --sbom=true \\\n    .\n}\n```\n\n## Container Signing\n```bash\nsign_container() {\n  local image=\"$1\"\n  \n  # Keyless signing with Cosign\n  cosign sign --yes \"$image\"\n  \n  # Attach SBOM\n  syft \"$image\" -o spdx-json | cosign attest --yes --predicate - --type spdx \"$image\"\n}\n```\n\n## dsr Command\n```bash\ndsr docker build <tool>           # Build and push\ndsr docker build <tool> --local   # Build only, don't push\ndsr docker sign <image>           # Sign with cosign\n```\n\n## Prerequisites on css\n- Docker with buildx\n- GHCR login (echo $GITHUB_TOKEN | docker login ghcr.io -u $USER --password-stdin)\n- Cosign installed\n\n## Success Criteria\n- [ ] Multi-arch images build correctly\n- [ ] Images pushed to GHCR\n- [ ] Cosign signatures attached\n- [ ] SBOM attestations included","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T13:30:36.001507944Z","created_by":"ubuntu","updated_at":"2026-01-30T13:30:49.477501597Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.3.8","depends_on_id":"bd-1jt.3","type":"parent-child","created_at":"2026-01-30T13:30:36.001507944Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.3.8","depends_on_id":"bd-1jt.3.1","type":"blocks","created_at":"2026-01-30T13:30:49.477466240Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.3.9","title":"Implement minisign key management and secure storage","description":"# Minisign Key Management and Secure Storage\n\n## Purpose\nCreate and protect the Minisign keypair used to sign release artifacts.\n\n## Key Generation (Minisign)\n```bash\nminisign -G -p minisign.pub -s ~/.config/dsr/secrets/minisign.key\n```\n- Private key must be **password-protected**\n- Public key is embedded in installers and docs\n\n## Storage Policy\n- Private key: `~/.config/dsr/secrets/minisign.key` (chmod 600)\n- Public key: `~/.config/dsr/minisign.pub` + published in README\n- Never store unencrypted key in repo or CI logs\n\n## Distribution Strategy\nRecommended: **central signing** on css after artifact collection. Avoid copying private keys to multiple hosts.\n\n## Success Criteria\n- [ ] Keypair generated with password prompt\n- [ ] Public key documented and embedded\n- [ ] Private key stored with strict permissions\n- [ ] Signing workflow uses central host only\n\n## References\n- https://jedisct1.github.io/minisign/","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T14:23:38.864145251Z","created_by":"ubuntu","updated_at":"2026-01-30T14:35:22.094358938Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.3.9","depends_on_id":"bd-1jt.3","type":"parent-child","created_at":"2026-01-30T14:23:38.864145251Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.4","title":"Theme 4: Smart Curl-Bash Installers","description":"# Smart Curl-Bash Installers\n\n## Purpose\nCreate intelligent install scripts for each tool that:\n1. Try to download latest release binary first (fastest)\n2. Detect if release is stale (>10 commits behind HEAD)\n3. Offer to build from source if stale or binary unavailable\n4. Auto-install required toolchains if user consents\n\n## Installer URL Pattern\nEach tool gets a hosted installer:\n- https://raw.githubusercontent.com/Dicklesworthstone/{tool}/main/install.sh\n- Or via short URL: curl -sSL https://install.{tool}.dev | bash\n\n## Usage\n\\`\\`\\`bash\n# Quick install (tries binary first)\ncurl -sSL https://raw.githubusercontent.com/Dicklesworthstone/ntm/main/install.sh | bash\n\n# Force source build\ncurl -sSL .../install.sh | bash -s -- --source\n\n# Install specific version\ncurl -sSL .../install.sh | bash -s -- --version v1.5.0\n\n# Install to custom location\ncurl -sSL .../install.sh | bash -s -- --prefix ~/.local\n\n# Non-interactive (CI mode)\ncurl -sSL .../install.sh | bash -s -- --yes\n\\`\\`\\`\n\n## Installer Logic Flow\n\n\\`\\`\\`\n1. Detect OS and Architecture\n   └─→ Linux x86_64, Linux ARM64, macOS ARM64, macOS x86_64, Windows\n\n2. Check Latest Release\n   └─→ gh api repos/Dicklesworthstone/{tool}/releases/latest\n\n3. Compare Release Freshness\n   └─→ Count commits between release tag and HEAD\n   └─→ If >10 commits behind, release is \"stale\"\n\n4. Decision Point\n   ├─→ Release exists AND fresh (<10 commits behind)?\n   │   └─→ Download binary → Install → Done\n   │\n   └─→ Release missing OR stale?\n       └─→ Prompt: \"Build from source? [y/N]\"\n           ├─→ No  → Install stale release anyway (with warning)\n           └─→ Yes → Check toolchain → Build → Install\n\\`\\`\\`\n\n## Freshness Check Implementation\n\\`\\`\\`bash\n# Get latest release tag\nlatest_tag=\\$(gh api repos/Dicklesworthstone/\\$TOOL/releases/latest --jq '.tag_name')\n\n# Count commits since release\ncommits_behind=\\$(gh api repos/Dicklesworthstone/\\$TOOL/compare/\\${latest_tag}...main --jq '.ahead_by')\n\nif [ \"\\$commits_behind\" -gt 10 ]; then\n  echo \"⚠️  Release \\$latest_tag is \\$commits_behind commits behind main\"\n  echo \"   Consider building from source for latest features\"\nfi\n\\`\\`\\`\n\n## Toolchain Auto-Installation\nWhen building from source, check and offer to install missing toolchains:\n\n### Rust\n\\`\\`\\`bash\nif ! command -v cargo &>/dev/null; then\n  echo \"Rust toolchain not found.\"\n  echo \"Install Rust nightly? [y/N]\"\n  read -r response\n  if [[ \"\\$response\" =~ ^[Yy] ]]; then\n    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y --default-toolchain nightly\n    source \"\\$HOME/.cargo/env\"\n  else\n    die \"Rust required for source build\"\n  fi\nfi\n\\`\\`\\`\n\n### Go\n\\`\\`\\`bash\nif ! command -v go &>/dev/null; then\n  echo \"Go toolchain not found.\"\n  echo \"Install latest Go? [y/N]\"\n  read -r response\n  if [[ \"\\$response\" =~ ^[Yy] ]]; then\n    # Detect OS/arch and download appropriate binary\n    GO_VERSION=\"1.23.0\"\n    GO_OS=\\$(uname -s | tr '[:upper:]' '[:lower:]')\n    GO_ARCH=\\$(uname -m | sed 's/x86_64/amd64/;s/aarch64/arm64/')\n    curl -sSL \"https://go.dev/dl/go\\${GO_VERSION}.\\${GO_OS}-\\${GO_ARCH}.tar.gz\" | sudo tar -C /usr/local -xzf -\n    export PATH=\\$PATH:/usr/local/go/bin\n  fi\nfi\n\\`\\`\\`\n\n### Bun\n\\`\\`\\`bash\nif ! command -v bun &>/dev/null; then\n  echo \"Bun not found.\"\n  echo \"Install Bun? [y/N]\"\n  read -r response\n  if [[ \"\\$response\" =~ ^[Yy] ]]; then\n    curl -fsSL https://bun.sh/install | bash\n    source \"\\$HOME/.bun/bin/bun\"\n  fi\nfi\n\\`\\`\\`\n\n## Cross-Platform Considerations\n\n### macOS\n- Use curl (built-in) not wget\n- Install to ~/.local/bin (user-writable) by default\n- Handle Gatekeeper for unsigned binaries (xattr -d com.apple.quarantine)\n\n### Linux\n- Check for sudo if installing to /usr/local/bin\n- Support both apt and rpm-based distros for dependencies\n- Handle SELinux contexts if necessary\n\n### Windows (WSL or Git Bash)\n- Detect WSL vs native Windows\n- Use .exe extension for binaries\n- Handle PATH differences\n\n## Success Criteria\n- [ ] Works on Linux x86_64, ARM64\n- [ ] Works on macOS ARM64, x86_64\n- [ ] Works on Windows (WSL at minimum)\n- [ ] Correctly detects stale releases\n- [ ] Toolchain installation is non-destructive\n- [ ] --yes flag for CI/automation\n- [ ] Detailed logging with --verbose\n- [ ] Graceful failure with clear error messages\n\n## Security Considerations\n- Verify checksums after download\n- Use HTTPS exclusively\n- Don't execute arbitrary code from failed downloads\n- Warn users about piping to bash","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:09:54.174177755Z","created_by":"ubuntu","updated_at":"2026-01-30T13:09:54.174177755Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.4","depends_on_id":"bd-1jt","type":"parent-child","created_at":"2026-01-30T13:09:54.174177755Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.4.1","title":"Implement install.sh template generator","description":"# Implement install.sh Template Generator\n\n## Purpose\nGenerate per-tool install scripts from a shared template while enforcing consistent safety, logging, and verification rules.\n\n## Required Template Rules\n- Use shebang: #!/usr/bin/env bash\n- Use set -uo pipefail (no set -e)\n- Explicit error handling for download/build/verify steps\n- stderr for human logs, stdout for JSON/paths (if --json supported)\n\n## Inputs\nFrom repos.yaml:\n- tool name, repo, language, build_cmd, binary_name, targets\n\n## Output\nGenerated scripts to ./installers/{tool}/install.sh\n\n## Success Criteria\n- [ ] All placeholders substituted correctly\n- [ ] Generated scripts pass ShellCheck (warning+)\n- [ ] Binary download, checksum, and source build flows work\n- [ ] Template supports minisign verification hooks (if enabled)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:10:20.508569888Z","created_by":"ubuntu","updated_at":"2026-01-30T14:39:22.919690068Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.4.1","depends_on_id":"bd-1jt.1.8","type":"blocks","created_at":"2026-01-30T14:39:02.476070991Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.4.1","depends_on_id":"bd-1jt.2.12","type":"blocks","created_at":"2026-01-30T14:39:22.919659290Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.4.1","depends_on_id":"bd-1jt.4","type":"parent-child","created_at":"2026-01-30T13:10:20.508569888Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.4.1","depends_on_id":"bd-1jt.4.2","type":"blocks","created_at":"2026-01-30T13:18:14.062990057Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.4.1","depends_on_id":"bd-1jt.7.1","type":"blocks","created_at":"2026-01-30T14:38:54.094130972Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.4.2","title":"Implement toolchain version detection and auto-installation in installers","description":"# Toolchain Version Detection and Auto-Installation\n\n## Purpose\nThe curl-bash installers must detect missing or outdated toolchains and offer to install them automatically, without breaking existing installations.\n\n## Supported Toolchains\n\n| Toolchain | Detect Command | Min Version | Install Method |\n|-----------|----------------|-------------|----------------|\n| Rust | rustc --version | nightly | rustup |\n| Go | go version | 1.21+ | official tarball |\n| Bun | bun --version | 1.0+ | official script |\n| Git | git --version | 2.0+ | package manager |\n\n## Detection Logic\n\n### Check if Command Exists\n\\`\\`\\`bash\nhas_command() {\n  command -v \"\\$1\" &>/dev/null\n}\n\\`\\`\\`\n\n### Check Version Meets Minimum\n\\`\\`\\`bash\nversion_gte() {\n  local have=\"\\$1\"\n  local need=\"\\$2\"\n  \n  # Compare semantic versions\n  printf '%s\\n%s' \"\\$need\" \"\\$have\" | sort -V -C\n}\n\ncheck_rust() {\n  if ! has_command rustc; then\n    return 1\n  fi\n  \n  local version=\\$(rustc --version | grep -oE '[0-9]+\\.[0-9]+\\.[0-9]+')\n  # For nightly, just check it exists\n  if rustc --version | grep -q nightly; then\n    return 0\n  fi\n  \n  version_gte \"\\$version\" \"1.75.0\"\n}\n\ncheck_go() {\n  if ! has_command go; then\n    return 1\n  fi\n  \n  local version=\\$(go version | grep -oE '[0-9]+\\.[0-9]+(\\.[0-9]+)?')\n  version_gte \"\\$version\" \"1.21\"\n}\n\\`\\`\\`\n\n## Installation Functions\n\n### Install Rust (Non-Destructive)\n\\`\\`\\`bash\ninstall_rust() {\n  if has_command rustup; then\n    log \"rustup found, ensuring nightly toolchain...\"\n    rustup install nightly\n    rustup default nightly\n  else\n    log \"Installing Rust via rustup...\"\n    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y --default-toolchain nightly\n    \n    # Source the env for this session\n    source \"\\$HOME/.cargo/env\"\n  fi\n  \n  # Verify\n  rustc --version || die \"Rust installation failed\"\n}\n\\`\\`\\`\n\n### Install Go (Non-Destructive)\n\\`\\`\\`bash\ninstall_go() {\n  local GO_VERSION=\"1.23.4\"\n  local GO_OS=\\$(uname -s | tr '[:upper:]' '[:lower:]')\n  local GO_ARCH=\\$(uname -m | sed 's/x86_64/amd64/;s/aarch64/arm64/')\n  \n  local INSTALL_DIR=\"/usr/local\"\n  local USE_SUDO=\"\"\n  \n  # Check if we need sudo\n  if [ ! -w \"\\$INSTALL_DIR\" ]; then\n    if has_command sudo; then\n      USE_SUDO=\"sudo\"\n    else\n      INSTALL_DIR=\"\\$HOME/.local\"\n      mkdir -p \"\\$INSTALL_DIR\"\n    fi\n  fi\n  \n  # Don't overwrite existing Go unless upgrading\n  if [ -d \"\\$INSTALL_DIR/go\" ]; then\n    log \"Go already installed in \\$INSTALL_DIR/go\"\n    log \"To upgrade, run: \\$USE_SUDO rm -rf \\$INSTALL_DIR/go\"\n    return 0\n  fi\n  \n  log \"Installing Go \\$GO_VERSION to \\$INSTALL_DIR...\"\n  curl -sSL \"https://go.dev/dl/go\\${GO_VERSION}.\\${GO_OS}-\\${GO_ARCH}.tar.gz\" | \\\n    \\$USE_SUDO tar -C \"\\$INSTALL_DIR\" -xzf -\n  \n  # Add to PATH for this session\n  export PATH=\"\\$PATH:\\$INSTALL_DIR/go/bin\"\n  \n  # Verify\n  go version || die \"Go installation failed\"\n  \n  # Suggest adding to shell profile\n  log \"Add to your shell profile:\"\n  log \"  export PATH=\\\\\\$PATH:\\$INSTALL_DIR/go/bin\"\n}\n\\`\\`\\`\n\n### Install Bun\n\\`\\`\\`bash\ninstall_bun() {\n  if has_command bun; then\n    log \"Bun already installed\"\n    return 0\n  fi\n  \n  log \"Installing Bun...\"\n  curl -fsSL https://bun.sh/install | bash\n  \n  # Source for this session\n  export BUN_INSTALL=\"\\$HOME/.bun\"\n  export PATH=\"\\$BUN_INSTALL/bin:\\$PATH\"\n  \n  bun --version || die \"Bun installation failed\"\n}\n\\`\\`\\`\n\n## User Prompting\n\n### Interactive Mode (Default)\n\\`\\`\\`bash\nprompt_install() {\n  local tool=\"\\$1\"\n  local reason=\"\\$2\"\n  \n  if [ \"\\$DSR_YES\" = \"1\" ]; then\n    # Non-interactive, auto-approve\n    return 0\n  fi\n  \n  echo \"\"\n  echo \"┌─────────────────────────────────────────────────┐\"\n  echo \"│  \\$tool is required but not installed            │\"\n  echo \"│  Reason: \\$reason                               │\"\n  echo \"└─────────────────────────────────────────────────┘\"\n  echo \"\"\n  printf \"Install \\$tool now? [y/N] \"\n  read -r response\n  \n  case \"\\$response\" in\n    [Yy]|[Yy][Ee][Ss]) return 0 ;;\n    *) return 1 ;;\n  esac\n}\n\\`\\`\\`\n\n### Non-Interactive Mode (--yes flag)\n\\`\\`\\`bash\n# Usage: curl ... | bash -s -- --yes\n\\`\\`\\`\n\n## Full Toolchain Check Flow\n\\`\\`\\`bash\nensure_toolchain() {\n  local lang=\"\\$1\"\n  \n  case \"\\$lang\" in\n    rust)\n      if ! check_rust; then\n        if prompt_install \"Rust\" \"Build from source\"; then\n          install_rust\n        else\n          die \"Rust required. Install with: curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh\"\n        fi\n      fi\n      ;;\n    go)\n      if ! check_go; then\n        if prompt_install \"Go\" \"Build from source\"; then\n          install_go\n        else\n          die \"Go 1.21+ required. Install from: https://go.dev/dl/\"\n        fi\n      fi\n      ;;\n    bun)\n      if ! has_command bun; then\n        if prompt_install \"Bun\" \"Build from source\"; then\n          install_bun\n        else\n          die \"Bun required. Install with: curl -fsSL https://bun.sh/install | bash\"\n        fi\n      fi\n      ;;\n  esac\n}\n\\`\\`\\`\n\n## Success Criteria\n- [ ] Detects existing installations correctly\n- [ ] Version checks work on all platforms\n- [ ] Installation doesn't break existing setups\n- [ ] Works with and without sudo\n- [ ] --yes flag skips prompts\n- [ ] Clear error messages when manual install needed\n- [ ] PATH updates work in current session","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:18:07.405296669Z","created_by":"ubuntu","updated_at":"2026-01-30T13:18:07.405296669Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.4.2","depends_on_id":"bd-1jt.4","type":"parent-child","created_at":"2026-01-30T13:18:07.405296669Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.4.3","title":"Add minisign verification to install.sh (optional but recommended)","description":"# Add Minisign Verification to install.sh (Optional but Recommended)\n\n## Purpose\nVerify downloaded binaries with minisign signatures to prevent tampering.\n\n## Behavior\n- If minisign available: verify by default\n- If missing: warn, optionally install, or fail when --require-signatures\n- Embed public key in installer (from dsr config)\n\n## Success Criteria\n- [ ] install.sh verifies .minisig when available\n- [ ] Clear failure if signature invalid\n- [ ] Non-interactive mode supports --require-signatures","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T14:37:11.776660104Z","created_by":"ubuntu","updated_at":"2026-01-30T14:39:57.697487452Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.4.3","depends_on_id":"bd-1jt.3.3","type":"blocks","created_at":"2026-01-30T14:39:57.206972391Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.4.3","depends_on_id":"bd-1jt.3.9","type":"blocks","created_at":"2026-01-30T14:39:57.459042194Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.4.3","depends_on_id":"bd-1jt.4","type":"parent-child","created_at":"2026-01-30T14:37:11.776660104Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.4.3","depends_on_id":"bd-1jt.4.1","type":"blocks","created_at":"2026-01-30T14:39:57.697458578Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.4.4","title":"Add installer cache/offline mode + gh release download fallback","description":"# Add Installer Cache/Offline Mode + gh release download Fallback\n\n## Purpose\nImprove reliability when network is flaky by caching release assets and allowing offline installs.\n\n## Behavior\n- Cache downloads in ~/.cache/dsr/installers/<tool>/<version>\n- Support --cache-dir and --offline flags\n- Prefer gh release download when gh is available (auth + retries)\n- Fallback to curl when gh is missing\n\n## Success Criteria\n- [ ] Cached assets reused when available\n- [ ] Offline mode fails fast with clear error if cache missing\n- [ ] gh release download works for private repos","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T14:37:19.727170447Z","created_by":"ubuntu","updated_at":"2026-01-30T14:40:04.030713593Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.4.4","depends_on_id":"bd-1jt.1.8","type":"blocks","created_at":"2026-01-30T14:39:02.979791158Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.4.4","depends_on_id":"bd-1jt.4","type":"parent-child","created_at":"2026-01-30T14:37:19.727170447Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.4.4","depends_on_id":"bd-1jt.4.1","type":"blocks","created_at":"2026-01-30T14:40:04.030679358Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.4.5","title":"Provide PowerShell installer wrapper for native Windows","description":"# Provide PowerShell Installer Wrapper for Native Windows\n\n## Purpose\nOffer a first-class Windows install path (install.ps1) that mirrors install.sh behavior for users not using WSL.\n\n## Behavior\n- Detect OS/arch, download matching .exe\n- Verify SHA256 (and minisign if available)\n- Install to user-writable PATH (e.g., %LOCALAPPDATA%\\Programs\\dsr\\bin)\n\n## Success Criteria\n- [ ] install.ps1 parity with install.sh (flags, logs)\n- [ ] Works on Windows 10/11 without admin\n- [ ] Documented usage in README","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-30T14:37:25.838673495Z","created_by":"ubuntu","updated_at":"2026-01-30T14:40:08.857296687Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.4.5","depends_on_id":"bd-1jt.1.8","type":"blocks","created_at":"2026-01-30T14:39:03.227926195Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.4.5","depends_on_id":"bd-1jt.4","type":"parent-child","created_at":"2026-01-30T14:37:25.838673495Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.4.5","depends_on_id":"bd-1jt.4.1","type":"blocks","created_at":"2026-01-30T14:40:08.359019185Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.4.5","depends_on_id":"bd-1jt.4.3","type":"blocks","created_at":"2026-01-30T14:40:08.618811604Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.4.5","depends_on_id":"bd-1jt.4.4","type":"blocks","created_at":"2026-01-30T14:40:08.857268243Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.5","title":"Theme 5: Testing & Validation","description":"# Testing & Validation\n\n## Purpose\nEnsure all components of the fallback release system work correctly through comprehensive unit tests and E2E validation scripts.\n\n## Testing Strategy\n\n### 1. Unit Tests\nTest individual functions in isolation:\n- Platform detection\n- Release freshness calculation\n- Checksum verification\n- Toolchain detection\n\n### 2. Integration Tests\nTest component interactions:\n- Check → Build → Release pipeline\n- Installer download → verify → install flow\n- Remote SSH builds\n\n### 3. E2E Tests\nFull workflow tests in realistic environments:\n- Docker containers for Linux\n- macOS VM (if available) or actual Mac mini\n- Windows via WSL\n\n## Test Framework\n\nUse bats (Bash Automated Testing System) for bash script tests:\n\\`\\`\\`bash\n# Install\nbrew install bats-core  # macOS\napt install bats        # Ubuntu\n\n# Run\nbats tests/\n\\`\\`\\`\n\n## Test Directory Structure\n\\`\\`\\`\ntests/\n├── unit/\n│   ├── test_platform_detection.bats\n│   ├── test_freshness_check.bats\n│   ├── test_checksum_verify.bats\n│   └── test_toolchain_detect.bats\n├── integration/\n│   ├── test_check_command.bats\n│   ├── test_build_command.bats\n│   └── test_release_command.bats\n├── e2e/\n│   ├── test_full_workflow.bats\n│   ├── test_installer_linux.bats\n│   └── test_installer_macos.bats\n├── fixtures/\n│   ├── mock_gh_responses/\n│   └── sample_repos/\n└── helpers/\n    ├── mock_ssh.bash\n    ├── mock_gh.bash\n    └── common.bash\n\\`\\`\\`\n\n## Logging Requirements\n\nAll tests must produce detailed logs:\n\\`\\`\\`bash\n# In test helpers\nsetup() {\n  TEST_LOG=\"\\$BATS_TEST_TMPDIR/test.log\"\n  exec 3>&1 4>&2 1>\"\\$TEST_LOG\" 2>&1\n  echo \"=== Test: \\$BATS_TEST_NAME ===\"\n  echo \"=== Started: \\$(date -Iseconds) ===\"\n}\n\nteardown() {\n  echo \"=== Ended: \\$(date -Iseconds) ===\"\n  exec 1>&3 2>&4\n  if [ \"\\$BATS_ERROR_STATUS\" -ne 0 ]; then\n    echo \"Test failed! Log:\"\n    cat \"\\$TEST_LOG\"\n  fi\n}\n\\`\\`\\`\n\n## Key Test Scenarios\n\n### Unit: Platform Detection\n\\`\\`\\`bash\n@test \"detect_platform on Linux x86_64\" {\n  # Mock uname\n  function uname() { \n    case \"\\$1\" in\n      -s) echo \"Linux\" ;;\n      -m) echo \"x86_64\" ;;\n    esac\n  }\n  export -f uname\n  \n  run detect_platform\n  assert_output --partial \"linux-amd64\"\n}\n\\`\\`\\`\n\n### Unit: Freshness Check\n\\`\\`\\`bash\n@test \"release 5 commits behind is fresh\" {\n  # Mock gh api to return ahead_by: 5\n  function gh() { echo '{\"ahead_by\": 5}'; }\n  export -f gh\n  \n  run check_freshness \"v1.0.0\"\n  assert_success\n}\n\n@test \"release 15 commits behind is stale\" {\n  function gh() { echo '{\"ahead_by\": 15}'; }\n  export -f gh\n  \n  run check_freshness \"v1.0.0\"\n  assert_failure\n}\n\\`\\`\\`\n\n### Integration: Build Command\n\\`\\`\\`bash\n@test \"dsr build ntm produces binary\" {\n  skip_if_no_toolchain \"go\"\n  \n  run dsr build ntm --target linux-amd64 --output-dir \"\\$BATS_TEST_TMPDIR\"\n  assert_success\n  assert [ -f \"\\$BATS_TEST_TMPDIR/ntm-linux-amd64\" ]\n  assert [ -x \"\\$BATS_TEST_TMPDIR/ntm-linux-amd64\" ]\n}\n\\`\\`\\`\n\n### E2E: Full Installer Flow\n\\`\\`\\`bash\n@test \"install.sh downloads and installs ntm\" {\n  # Run installer in Docker\n  run docker run --rm ubuntu:22.04 bash -c \"\n    apt-get update && apt-get install -y curl\n    curl -sSL file:///install.sh | bash -s -- --yes\n    ntm --version\n  \"\n  assert_success\n  assert_output --partial \"ntm\"\n}\n\\`\\`\\`\n\n## CI Integration\nTests should run:\n- On every commit to dsr repo\n- Before each release\n- Nightly for E2E tests (more expensive)\n\n## Success Criteria\n- [ ] 100% unit test coverage for core functions\n- [ ] Integration tests for all commands\n- [ ] E2E tests for Linux installer\n- [ ] All tests have detailed logging\n- [ ] Tests run in <5 minutes (unit + integration)\n- [ ] E2E tests run in <30 minutes","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:10:44.485219623Z","created_by":"ubuntu","updated_at":"2026-01-30T13:10:44.485219623Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.5","depends_on_id":"bd-1jt","type":"parent-child","created_at":"2026-01-30T13:10:44.485219623Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.5.1","title":"Write unit tests for platform detection and freshness checking","description":"# Unit Tests: Platform Detection & Freshness Checking\n\n## Test File\ntests/unit/test_core_functions.bats\n\n## Platform Detection Tests\n\n### Test Cases\n\\`\\`\\`bash\n@test \"detect Linux x86_64\" {\n  mock_uname \"Linux\" \"x86_64\"\n  run detect_platform\n  assert_equal \"\\$PLATFORM\" \"linux-amd64\"\n}\n\n@test \"detect Linux ARM64\" {\n  mock_uname \"Linux\" \"aarch64\"\n  run detect_platform\n  assert_equal \"\\$PLATFORM\" \"linux-arm64\"\n}\n\n@test \"detect macOS ARM64 (Apple Silicon)\" {\n  mock_uname \"Darwin\" \"arm64\"\n  run detect_platform\n  assert_equal \"\\$PLATFORM\" \"darwin-arm64\"\n}\n\n@test \"detect macOS x86_64 (Intel)\" {\n  mock_uname \"Darwin\" \"x86_64\"\n  run detect_platform\n  assert_equal \"\\$PLATFORM\" \"darwin-amd64\"\n}\n\n@test \"detect Windows via MINGW\" {\n  mock_uname \"MINGW64_NT-10.0\" \"x86_64\"\n  run detect_platform\n  assert_equal \"\\$PLATFORM\" \"windows-amd64\"\n}\n\n@test \"unsupported OS fails gracefully\" {\n  mock_uname \"FreeBSD\" \"amd64\"\n  run detect_platform\n  assert_failure\n  assert_output --partial \"Unsupported OS\"\n}\n\n@test \"unsupported arch fails gracefully\" {\n  mock_uname \"Linux\" \"riscv64\"\n  run detect_platform\n  assert_failure\n  assert_output --partial \"Unsupported architecture\"\n}\n\\`\\`\\`\n\n## Freshness Check Tests\n\n### Test Cases\n\\`\\`\\`bash\n@test \"release 0 commits behind is fresh\" {\n  mock_gh_compare 0\n  run check_freshness \"v1.0.0\"\n  assert_success\n}\n\n@test \"release 10 commits behind is fresh (boundary)\" {\n  mock_gh_compare 10\n  run check_freshness \"v1.0.0\"\n  assert_success\n}\n\n@test \"release 11 commits behind is stale (boundary)\" {\n  mock_gh_compare 11\n  run check_freshness \"v1.0.0\"\n  assert_failure\n  assert_output --partial \"commits behind\"\n}\n\n@test \"release 100 commits behind is very stale\" {\n  mock_gh_compare 100\n  run check_freshness \"v1.0.0\"\n  assert_failure\n  assert_output --partial \"100 commits behind\"\n}\n\n@test \"freshness check handles API error\" {\n  mock_gh_error \"rate limit exceeded\"\n  run check_freshness \"v1.0.0\"\n  # Should warn but not fail hard\n  assert_success\n  assert_output --partial \"Could not check freshness\"\n}\n\n@test \"freshness check without gh CLI uses curl fallback\" {\n  unset_command \"gh\"\n  mock_curl_compare 5\n  run check_freshness \"v1.0.0\"\n  assert_success\n}\n\\`\\`\\`\n\n## Mock Helpers\n\\`\\`\\`bash\n# tests/helpers/mocks.bash\n\nmock_uname() {\n  local os=\"\\$1\" arch=\"\\$2\"\n  function uname() {\n    case \"\\$1\" in\n      -s) echo \"\\$os\" ;;\n      -m) echo \"\\$arch\" ;;\n    esac\n  }\n  export -f uname\n}\n\nmock_gh_compare() {\n  local ahead_by=\"\\$1\"\n  function gh() {\n    if [[ \"\\$*\" == *\"compare\"* ]]; then\n      echo \"{\\\"ahead_by\\\": \\$ahead_by}\"\n    fi\n  }\n  export -f gh\n}\n\nmock_gh_error() {\n  local error=\"\\$1\"\n  function gh() {\n    echo \"gh: \\$error\" >&2\n    return 1\n  }\n  export -f gh\n}\n\\`\\`\\`\n\n## Logging Output\nEach test logs:\n- Input parameters\n- Mock configuration\n- Function output\n- Assertions checked\n\n## Success Criteria\n- [ ] All platform combinations tested\n- [ ] Boundary conditions for freshness tested\n- [ ] Error cases handled\n- [ ] Mock helpers reusable\n- [ ] Tests run in <10 seconds","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T13:11:32.707115669Z","created_by":"ubuntu","updated_at":"2026-01-30T13:15:53.451332866Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.5.1","depends_on_id":"bd-1jt.4.1","type":"blocks","created_at":"2026-01-30T13:15:53.451303881Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.1","depends_on_id":"bd-1jt.5","type":"parent-child","created_at":"2026-01-30T13:11:32.707115669Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.5.10","title":"Write tests for config loader + doctor + GitHub API adapter","description":"# Tests for Config Loader + Doctor + GitHub API Adapter\n\n## Coverage\n- Config precedence (flags > env > file > defaults)\n- Schema validation failures\n- Doctor detection for missing deps\n- API adapter caching (ETag) + rate-limit handling\n\n## Success Criteria\n- [ ] Unit tests for config resolution\n- [ ] Integration tests for doctor outputs\n- [ ] Mocked API adapter tests with cache hits/misses","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T14:37:37.282238775Z","created_by":"ubuntu","updated_at":"2026-01-30T14:40:28.273557298Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.5.10","depends_on_id":"bd-1jt.1.8","type":"blocks","created_at":"2026-01-30T14:40:27.472206911Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.10","depends_on_id":"bd-1jt.1.9","type":"blocks","created_at":"2026-01-30T14:40:28.002220529Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.10","depends_on_id":"bd-1jt.5","type":"parent-child","created_at":"2026-01-30T14:37:37.282238775Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.10","depends_on_id":"bd-1jt.5.9","type":"blocks","created_at":"2026-01-30T14:40:13.484175153Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.10","depends_on_id":"bd-1jt.7.1","type":"blocks","created_at":"2026-01-30T14:40:28.273524616Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.10","depends_on_id":"bd-1jt.7.2","type":"blocks","created_at":"2026-01-30T14:40:27.754759591Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.5.11","title":"Write tests for build lock/state + manifest schema","description":"# Tests for Build Lock/State + Manifest Schema\n\n## Coverage\n- Lock acquisition + contention\n- State file updates per host\n- Resume skips completed hosts\n- Manifest schema validation\n\n## Success Criteria\n- [ ] Unit tests for lock behavior\n- [ ] Integration tests for resume\n- [ ] Manifest validation in tests","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T14:37:43.882689574Z","created_by":"ubuntu","updated_at":"2026-01-30T14:40:13.745931479Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.5.11","depends_on_id":"bd-1jt.2.11","type":"blocks","created_at":"2026-01-30T14:39:17.072323656Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.11","depends_on_id":"bd-1jt.2.12","type":"blocks","created_at":"2026-01-30T14:39:23.184590351Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.11","depends_on_id":"bd-1jt.5","type":"parent-child","created_at":"2026-01-30T14:37:43.882689574Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.11","depends_on_id":"bd-1jt.5.9","type":"blocks","created_at":"2026-01-30T14:40:13.745895842Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.5.12","title":"Write tests for release verification + retry/resume","description":"# Tests for Release Verification + Retry/Resume\n\n## Coverage\n- Compare release assets vs manifest\n- Detect missing assets\n- Retry only failed uploads\n- JSON report integrity\n\n## Success Criteria\n- [ ] Unit tests for asset comparison\n- [ ] Integration tests with mocked gh output\n- [ ] Retry logic covered","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T14:37:48.801803536Z","created_by":"ubuntu","updated_at":"2026-01-30T14:40:31.411879021Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.5.12","depends_on_id":"bd-1jt.2.12","type":"blocks","created_at":"2026-01-30T14:39:23.447325820Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.12","depends_on_id":"bd-1jt.3.10","type":"blocks","created_at":"2026-01-30T14:40:31.411846330Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.12","depends_on_id":"bd-1jt.5","type":"parent-child","created_at":"2026-01-30T14:37:48.801803536Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.12","depends_on_id":"bd-1jt.5.9","type":"blocks","created_at":"2026-01-30T14:40:14.003933558Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.5.13","title":"Write tests for installer signatures + cache/offline mode","description":"# Tests for Installer Signatures + Cache/Offline Mode\n\n## Coverage\n- Signature verification success/fail\n- --require-signatures behavior\n- Cache hit/miss logic\n- Offline mode error messaging\n\n## Success Criteria\n- [ ] Unit tests for signature verification\n- [ ] E2E tests in Docker for cache/offline paths\n- [ ] Logs captured on failure","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T14:37:53.595519245Z","created_by":"ubuntu","updated_at":"2026-01-30T14:40:37.363470683Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.5.13","depends_on_id":"bd-1jt.2.12","type":"blocks","created_at":"2026-01-30T14:39:23.713074981Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.13","depends_on_id":"bd-1jt.4.3","type":"blocks","created_at":"2026-01-30T14:40:37.099272001Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.13","depends_on_id":"bd-1jt.4.4","type":"blocks","created_at":"2026-01-30T14:40:37.363437611Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.13","depends_on_id":"bd-1jt.5","type":"parent-child","created_at":"2026-01-30T14:37:53.595519245Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.13","depends_on_id":"bd-1jt.5.9","type":"blocks","created_at":"2026-01-30T14:40:14.244793511Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.5.14","title":"Write E2E fallback pipeline test (act + mock release)","description":"# E2E Fallback Pipeline Test (act + Mock Release)\n\n## Purpose\nValidate the full fallback flow end-to-end in a controlled environment.\n\n## Flow\n1. Simulate throttling (mock dsr check)\n2. Run dsr fallback --dry-run and --execute\n3. Use act to produce Linux artifacts\n4. Mock gh release create/upload\n5. Verify manifest + checksums\n\n## Success Criteria\n- [ ] Full pipeline completes in CI\n- [ ] Logs captured for each step\n- [ ] Failures pinpointed with clear errors","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T14:38:02.685624311Z","created_by":"ubuntu","updated_at":"2026-01-30T14:40:42.203047976Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.5.14","depends_on_id":"bd-1jt.1.4","type":"blocks","created_at":"2026-01-30T14:40:41.443215257Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.14","depends_on_id":"bd-1jt.2.1","type":"blocks","created_at":"2026-01-30T14:40:41.704213606Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.14","depends_on_id":"bd-1jt.2.4","type":"blocks","created_at":"2026-01-30T14:40:42.203004484Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.14","depends_on_id":"bd-1jt.3.1","type":"blocks","created_at":"2026-01-30T14:40:41.945669882Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.14","depends_on_id":"bd-1jt.5","type":"parent-child","created_at":"2026-01-30T14:38:02.685624311Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.14","depends_on_id":"bd-1jt.5.9","type":"blocks","created_at":"2026-01-30T14:40:14.489194960Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.5.2","title":"Write E2E tests for installer scripts using Docker","description":"# E2E Tests for Installer Scripts\n\n## Purpose\nValidate that generated install.sh scripts work correctly in real environments using Docker containers.\n\n## Test File\ntests/e2e/test_installers.bats\n\n## Test Environments\nUse Docker images to simulate fresh systems:\n- ubuntu:22.04 (Linux x64)\n- debian:bookworm (alternative Linux)\n- arm64v8/ubuntu:22.04 (Linux ARM64, needs QEMU)\n\n## Test Cases\n\n### Basic Install Flow\n\\`\\`\\`bash\n@test \"install.sh downloads and installs ntm on Ubuntu\" {\n  run docker run --rm -v \"\\$PWD/installers:/installers\" ubuntu:22.04 bash -c \"\n    set -x\n    apt-get update -qq\n    apt-get install -y -qq curl ca-certificates\n    bash /installers/ntm/install.sh --yes --verbose\n    which ntm\n    ntm --version\n  \"\n  assert_success\n  assert_output --partial \"ntm\"\n}\n\\`\\`\\`\n\n### Source Build Flow\n\\`\\`\\`bash\n@test \"install.sh builds from source when --source flag used\" {\n  skip_if_slow\n  \n  run docker run --rm -v \"\\$PWD/installers:/installers\" ubuntu:22.04 bash -c \"\n    apt-get update -qq\n    apt-get install -y -qq curl git build-essential\n    bash /installers/ntm/install.sh --source --yes --verbose 2>&1\n    which ntm\n    ntm --version\n  \"\n  assert_success\n}\n\\`\\`\\`\n\n### Stale Release Detection\n\\`\\`\\`bash\n@test \"install.sh warns about stale release\" {\n  run docker run --rm ubuntu:22.04 bash -c \"\n    export MOCK_COMMITS_BEHIND=50\n    bash /installers/test-tool/install.sh --verbose 2>&1\n  \"\n  assert_output --partial \"commits behind\"\n  assert_output --partial \"Consider building from source\"\n}\n\\`\\`\\`\n\n### Checksum Verification\n\\`\\`\\`bash\n@test \"install.sh verifies checksum on download\" {\n  run docker run --rm ubuntu:22.04 bash -c \"\n    bash /installers/ntm/install.sh --yes --verbose 2>&1\n  \"\n  assert_success\n  assert_output --partial \"Verifying checksum\"\n}\n\\`\\`\\`\n\n### Custom Install Location\n\\`\\`\\`bash\n@test \"install.sh respects PREFIX environment variable\" {\n  run docker run --rm ubuntu:22.04 bash -c \"\n    export PREFIX=/opt/custom\n    mkdir -p /opt/custom/bin\n    bash /installers/ntm/install.sh --yes --verbose\n    test -x /opt/custom/bin/ntm\n  \"\n  assert_success\n}\n\\`\\`\\`\n\n## Test Infrastructure\n\n### Docker Compose for E2E\n\\`\\`\\`yaml\nversion: '3'\nservices:\n  ubuntu-amd64:\n    image: ubuntu:22.04\n    platform: linux/amd64\n    volumes:\n      - ../../installers:/installers:ro\n    command: sleep infinity\n\\`\\`\\`\n\n### Running E2E Tests\n\\`\\`\\`bash\ndocker compose -f tests/e2e/docker-compose.yml up -d\nbats tests/e2e/\ndocker compose -f tests/e2e/docker-compose.yml down\n\\`\\`\\`\n\n## Logging\nEach E2E test captures:\n- Full Docker output\n- Installer verbose logs\n- Timing information\n\n## Success Criteria\n- [ ] Tests pass on Ubuntu x64\n- [ ] Source build tests work\n- [ ] Checksum verification tested\n- [ ] Tests complete in 30 minutes or less","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T13:13:18.607161544Z","created_by":"ubuntu","updated_at":"2026-01-30T13:15:54.630114637Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.5.2","depends_on_id":"bd-1jt.4.1","type":"blocks","created_at":"2026-01-30T13:15:54.630086373Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.2","depends_on_id":"bd-1jt.5","type":"parent-child","created_at":"2026-01-30T13:13:18.607161544Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.5.3","title":"Write integration tests for dsr commands","description":"# Integration Tests for dsr Commands\n\n## Purpose\nTest that dsr commands work correctly with real (mocked) GH API responses and actual tool interactions.\n\n## Test File\ntests/integration/test_commands.bats\n\n## Test Cases\n\n### dsr check\n\\`\\`\\`bash\n@test \"dsr check detects queued run over threshold\" {\n  export GH_MOCK_RESPONSE='[{\"status\":\"queued\",\"createdAt\":\"2026-01-30T12:00:00Z\"}]'\n  # Assume current time is 12:15 (15 min queued)\n  run dsr check ntm\n  assert_failure\n  assert_output --partial \"THROTTLED\"\n  assert_output --partial \"15\"\n}\n\n@test \"dsr check passes for running workflow\" {\n  export GH_MOCK_RESPONSE='[{\"status\":\"in_progress\",\"createdAt\":\"2026-01-30T12:00:00Z\"}]'\n  run dsr check ntm\n  assert_success\n  assert_output --partial \"OK\"\n}\n\n@test \"dsr check --json outputs valid JSON\" {\n  run dsr check ntm --json\n  echo \"\\$output\" | jq . # Validates JSON\n  assert_success\n}\n\\`\\`\\`\n\n### dsr repos\n\\`\\`\\`bash\n@test \"dsr repos list shows all 16 tools\" {\n  run dsr repos list\n  assert_success\n  assert_output --partial \"ntm\"\n  assert_output --partial \"cass\"\n  assert_output --partial \"bv\"\n  # Count lines should be 16\n  [ \"\\$(echo \"\\$output\" | wc -l)\" -ge 16 ]\n}\n\n@test \"dsr repos info shows tool details\" {\n  run dsr repos info ntm --json\n  assert_success\n  assert_output --partial \"Dicklesworthstone/ntm\"\n  assert_output --partial \"go\"\n}\n\\`\\`\\`\n\n### dsr build\n\\`\\`\\`bash\n@test \"dsr build --dry-run shows planned actions\" {\n  run dsr build ntm --dry-run\n  assert_success\n  assert_output --partial \"Would build\"\n  assert_output --partial \"linux-amd64\"\n  assert_output --partial \"darwin-arm64\"\n}\n\n@test \"dsr build with invalid tool fails\" {\n  run dsr build nonexistent-tool\n  assert_failure\n  assert_output --partial \"Unknown tool\"\n}\n\\`\\`\\`\n\n### dsr release\n\\`\\`\\`bash\n@test \"dsr release --dry-run shows upload plan\" {\n  mkdir -p /tmp/test-artifacts\n  touch /tmp/test-artifacts/ntm-linux-amd64\n  \n  run dsr release ntm v1.0.0 --artifacts /tmp/test-artifacts --dry-run\n  assert_success\n  assert_output --partial \"Would upload\"\n  assert_output --partial \"ntm-linux-amd64\"\n}\n\\`\\`\\`\n\n## Mock Setup\n\n### GH API Mocking\n\\`\\`\\`bash\n# tests/helpers/mock_gh.bash\nmock_gh() {\n  function gh() {\n    if [ -n \"\\$GH_MOCK_RESPONSE\" ]; then\n      echo \"\\$GH_MOCK_RESPONSE\"\n      return 0\n    fi\n    command gh \"\\$@\"\n  }\n  export -f gh\n}\n\\`\\`\\`\n\n### SSH Mocking (for build tests)\n\\`\\`\\`bash\n# tests/helpers/mock_ssh.bash\nmock_ssh() {\n  function ssh() {\n    local host=\"\\$1\"\n    shift\n    echo \"MOCK SSH to \\$host: \\$*\"\n    return 0\n  }\n  export -f ssh\n}\n\\`\\`\\`\n\n## Running Integration Tests\n\\`\\`\\`bash\n# Run with mocks\nbats tests/integration/\n\n# Run against real GH API (careful: rate limits)\nREAL_GH=1 bats tests/integration/\n\\`\\`\\`\n\n## Success Criteria\n- [ ] All dsr commands have tests\n- [ ] Mocking infrastructure works\n- [ ] Tests run in under 2 minutes\n- [ ] Edge cases covered (errors, timeouts)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T13:15:05.278042146Z","created_by":"ubuntu","updated_at":"2026-01-30T13:15:58.531462913Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.5.3","depends_on_id":"bd-1jt.1.1","type":"blocks","created_at":"2026-01-30T13:15:56.036145566Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.3","depends_on_id":"bd-1jt.2.1","type":"blocks","created_at":"2026-01-30T13:15:58.531434369Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.3","depends_on_id":"bd-1jt.5","type":"parent-child","created_at":"2026-01-30T13:15:05.278042146Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.5.4","title":"Implement comprehensive logging infrastructure for dsr","description":"# Comprehensive Logging Infrastructure for dsr\n\n## Purpose\nProvide deterministic, structured logs for every action so failures are diagnosable, retries are safe, and audit trails exist for releases.\n\n## Core Principles\n- **Structured JSON Lines** for machine parsing\n- **stderr** for human logs, **stdout** reserved for JSON output\n- **No `set -e`**: explicit error handling with captured exit codes\n- Stable `DSR_RUN_ID` to correlate events across commands\n\n## Log Schema (JSONL)\n```json\n{\"ts\":\"2026-01-30T13:14:22Z\",\"run_id\":\"run-...\",\"level\":\"info\",\"cmd\":\"build\",\"tool\":\"ntm\",\"msg\":\"Starting build\",\"host\":\"css\"}\n```\n\n## Log Locations\n- `~/.local/state/dsr/logs/dsr-<timestamp>.log`\n- `~/.local/state/dsr/builds/<tool>/<version>/<run_id>/` (per-host logs + metadata)\n\n## Required Fields\n- `ts`, `run_id`, `level`, `cmd`\n- `tool`, `version` (when applicable)\n- `host`, `target`, `duration_ms`, `exit_code`\n\n## Retention\n- Keep last 30 days of session logs\n- Compress logs older than 7 days\n\n## Success Criteria\n- [ ] Every command emits structured logs\n- [ ] Logs are correlated by `run_id`\n- [ ] stderr/stdout separation enforced\n- [ ] Retention policy implemented","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T13:17:36.274359993Z","created_by":"ubuntu","updated_at":"2026-01-30T14:34:06.498254600Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.5.4","depends_on_id":"bd-1jt.7","type":"parent-child","created_at":"2026-01-30T14:34:06.498228160Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.5.5","title":"Implement installer canary testing in Docker","description":"# Installer Canary Testing\n\n## Purpose\nAutomated daily testing of installer scripts in fresh Docker containers. Catches regressions before users encounter them. Mirrors installer-canary.yml.\n\n## Test Matrix\n| OS | Image | Modes |\n|----|-------|-------|\n| Ubuntu 24.04 | ubuntu:24.04 | vibe, safe |\n| Ubuntu 25.04 | ubuntu:25.04 | vibe, safe |\n| Debian 12 | debian:12 | vibe, safe |\n| Fedora 39 | fedora:39 | vibe, safe |\n| macOS (native) | via mmini | vibe, safe |\n\n## Implementation\n```bash\nrun_canary_test() {\n  local os=\"$1\"\n  local mode=\"$2\"\n  local tool=\"$3\"\n  \n  docker run --rm -v \"$(pwd)/install.sh:/install.sh:ro\" \\\n    \"$os\" bash -c \"\n      apt-get update && apt-get install -y curl\n      curl -sSL https://raw.githubusercontent.com/Dicklesworthstone/$tool/main/install.sh | bash -s -- --mode $mode\n      $tool --version\n    \"\n}\n```\n\n## Canary Test Script\ntests/canary/test_install.sh:\n- Test all tools on fresh container\n- Verify binary runs (--version, --help)\n- Check PATH installation\n- Verify toolchain auto-installation\n- Test source build fallback\n\n## dsr Command\n```bash\ndsr canary run --all              # Test all tools\ndsr canary run ntm --os ubuntu:24.04\ndsr canary run --matrix           # Full matrix test\ndsr canary schedule               # Setup daily cron\n```\n\n## Success Criteria\n- [ ] All 16 tools pass canary on Ubuntu 24.04\n- [ ] macOS canary via SSH to mmini\n- [ ] Detailed logs on failure\n- [ ] Exit codes propagate correctly\n- [ ] Scheduled daily runs","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T13:29:10.386513793Z","created_by":"ubuntu","updated_at":"2026-01-30T13:30:48.474386670Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.5.5","depends_on_id":"bd-1jt.4.1","type":"blocks","created_at":"2026-01-30T13:30:48.474349540Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.5","depends_on_id":"bd-1jt.5","type":"parent-child","created_at":"2026-01-30T13:29:10.386513793Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.5.6","title":"Implement upgrade command verification after release","description":"# Upgrade Command Verification\n\n## Purpose\nAfter releasing binaries, verify that each tool's `upgrade --check` command correctly finds and downloads the new release assets. Catches asset naming mismatches between code and build configs.\n\n## Why This Matters\n- Go tools use upgrade.go to detect GOOS/GOARCH and fetch assets\n- Rust tools use self-update crates\n- Asset naming must match exactly between build and upgrade code\n- This verifies the contract end-to-end\n\n## Test Matrix\nRun on each platform after release:\n| Platform | Command | Expected |\n|----------|---------|----------|\n| Linux amd64 | `tool upgrade --check` | Found asset matching linux-amd64 |\n| Linux arm64 | `tool upgrade --check` | Found asset matching linux-arm64 |\n| macOS arm64 | `tool upgrade --check` | Found asset matching darwin-arm64 |\n| macOS amd64 | `tool upgrade --check` | Found asset matching darwin-amd64 |\n| Windows amd64 | `tool upgrade --check` | Found asset matching windows-amd64 |\n\n## Implementation\n```bash\nverify_upgrade() {\n  local tool=\"$1\"\n  local version=\"$2\"\n  \n  # Build tool from source first\n  cd \"/data/projects/$tool\"\n  go build -o \"$tool\" ./cmd/\"$tool\" 2>/dev/null || cargo build --release\n  \n  # Run upgrade check\n  output=$(\"\\./$tool\" upgrade --check 2>&1)\n  \n  if echo \"$output\" | grep -q \"no suitable release asset\"; then\n    echo \"ERROR: Asset naming mismatch for $tool on $(uname -s)/$(uname -m)\"\n    return 1\n  fi\n  \n  echo \"✓ Upgrade check passed for $tool\"\n}\n```\n\n## dsr Command\n```bash\ndsr verify upgrade <tool>         # Verify on current platform\ndsr verify upgrade <tool> --all   # Verify on all platforms via SSH\n```\n\n## Success Criteria\n- [ ] All 16 tools pass upgrade check on all 5 platforms\n- [ ] Clear error on asset mismatch\n- [ ] Runs automatically after dsr release","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T13:29:24.668487557Z","created_by":"ubuntu","updated_at":"2026-01-30T13:30:48.638706686Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.5.6","depends_on_id":"bd-1jt.3.1","type":"blocks","created_at":"2026-01-30T13:30:48.638677982Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.6","depends_on_id":"bd-1jt.5","type":"parent-child","created_at":"2026-01-30T13:29:24.668487557Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.5.7","title":"Write tests for host health checking and retry logic","description":"# Tests for Host Health and Retry Logic\n\n## Unit Tests for Host Health (tests/unit/test_host_health.bats)\n- SSH connectivity check succeeds/fails\n- Disk space threshold detection\n- Toolchain availability verification\n- Docker status check\n- Timeout handling\n\n## Unit Tests for Retry Logic (tests/unit/test_retry.bats)\n- Exponential backoff timing\n- Max retry limit reached\n- State persistence and resume\n- Partial success handling\n- Idempotent operation verification\n\n## Integration Tests\n- Health check against mock SSH server\n- Retry with simulated failures\n- State file creation and reading\n- Resume after partial build\n\n## Success Criteria\n- [ ] All retry edge cases covered\n- [ ] Host health scenarios tested\n- [ ] State persistence verified\n- [ ] Tests run in < 30 seconds","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T14:23:48.640909794Z","created_by":"ubuntu","updated_at":"2026-01-30T14:24:03.438284465Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.5.7","depends_on_id":"bd-1jt.2.8","type":"blocks","created_at":"2026-01-30T14:24:03.222446921Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.7","depends_on_id":"bd-1jt.2.9","type":"blocks","created_at":"2026-01-30T14:24:03.438255220Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.7","depends_on_id":"bd-1jt.5","type":"parent-child","created_at":"2026-01-30T14:23:48.640909794Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.5.8","title":"Write tests for notification system","description":"# Tests for Notification System\n\n## Unit Tests (tests/unit/test_notifications.bats)\n- Terminal notification on macOS (osascript)\n- Terminal notification on Linux (notify-send)  \n- Fallback to terminal bell\n- ntm integration when running\n- Slack webhook formatting\n- Email formatting\n- Event filtering (only enabled events)\n- Config loading\n\n## Integration Tests\n- Mock osascript/notify-send commands\n- Verify webhook HTTP call format\n- Verify non-blocking behavior\n\n## Success Criteria\n- [ ] All notification channels tested\n- [ ] Event filtering verified\n- [ ] Non-blocking behavior confirmed\n- [ ] Error handling (failed sends don't crash)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T14:24:11.907814286Z","created_by":"ubuntu","updated_at":"2026-01-30T14:24:17.242445310Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.5.8","depends_on_id":"bd-1jt.1.6","type":"blocks","created_at":"2026-01-30T14:24:17.242413339Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.5.8","depends_on_id":"bd-1jt.5","type":"parent-child","created_at":"2026-01-30T14:24:11.907814286Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.5.9","title":"Test harness: deterministic time/random + log capture helpers","description":"# Test Harness: Deterministic Time/Random + Log Capture Helpers\n\n## Purpose\nEliminate flaky tests by controlling time and randomness, and ensure logs are captured for debugging.\n\n## Deliverables\n- Helper to freeze time (mock date)\n- Seeded random helper (no Math.random equivalents)\n- Standard log capture in bats setup/teardown\n\n## Success Criteria\n- [ ] Tests reproducible across runs\n- [ ] Logs preserved on failure\n- [ ] Helpers reused by unit/integration/e2e tests","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T14:37:31.166867035Z","created_by":"ubuntu","updated_at":"2026-01-30T14:37:31.166867035Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.5.9","depends_on_id":"bd-1jt.5","type":"parent-child","created_at":"2026-01-30T14:37:31.166867035Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.6","title":"Create dsr skill for Claude Code (/dsr)","description":"# Create dsr Skill for Claude Code\n\n## Purpose\nCreate a skill in /cs (Claude skills directory) that teaches Claude Code how to use the dsr (Doodlestein Self-Releaser) system effectively.\n\n## Location\n/home/ubuntu/.claude/skills/dsr/SKILL.md\n\n## Skill Should Cover\n\n### 1. Overview\n- What dsr is and why it exists\n- When GH Actions throttling occurs\n- The fallback build infrastructure\n\n### 2. Commands Reference\n\\`\\`\\`\ndsr check <repo>           # Check if GH Actions is throttled\ndsr watch                  # Monitor all repos continuously  \ndsr build <tool>           # Build locally\ndsr release <tool> <ver>   # Create release and upload\ndsr installer generate     # Generate install.sh scripts\ndsr repos list             # List configured tools\n\\`\\`\\`\n\n### 3. Common Workflows\n- \"GH Actions is stuck\" → Run dsr check, then dsr build, then dsr release\n- \"Need to release ntm\" → dsr build ntm && dsr release ntm v1.5.2\n- \"Update all installers\" → dsr installer generate --all\n\n### 4. Build Host Reference\n| Host | Alias | Purpose |\n|------|-------|---------|\n| Contabo | css | Linux builds |\n| Mac mini | mmini | macOS builds |\n\n### 5. Troubleshooting\n- SSH connection fails → Check Tailscale for mmini\n- Build fails → Check toolchain versions\n- Release upload fails → Verify gh auth\n\n## Creation Process\nUse /sc and /sw to:\n1. Research the dsr codebase once implemented\n2. Extract key commands and patterns\n3. Generate SKILL.md following skill template\n4. Validate with /sw\n\n## Dependencies\n- dsr must be implemented first (all themes)\n- Documentation should be complete\n- Example workflows tested\n\n## Success Criteria\n- [ ] Skill activates on /dsr command\n- [ ] All dsr subcommands documented\n- [ ] Troubleshooting section helpful\n- [ ] Examples are copy-pasteable\n- [ ] Skill passes /sw validation","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T13:11:00.749384136Z","created_by":"ubuntu","updated_at":"2026-01-30T13:16:01.194324185Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.6","depends_on_id":"bd-1jt","type":"parent-child","created_at":"2026-01-30T13:11:00.749384136Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.6","depends_on_id":"bd-1jt.1.4","type":"blocks","created_at":"2026-01-30T13:15:59.973284449Z","created_by":"ubuntu","metadata":"{}","thread_id":""},{"issue_id":"bd-1jt.6","depends_on_id":"bd-1jt.5","type":"blocks","created_at":"2026-01-30T13:16:01.194287897Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.7","title":"Theme 0: Core CLI, Config & Runtime Contracts","description":"# Theme 0: Core CLI, Config & Runtime Contracts\n\n## Purpose\nDefine the non-negotiable contracts that every `dsr` command adheres to: CLI flags, output streams, JSON schema, exit codes, config layering, and state directories.\n\n## Why this matters\nReliability depends on consistency. If command behavior varies (output format, exit codes, config resolution), automation becomes brittle and debugging becomes guesswork. This theme establishes the foundation all other themes build on.\n\n## Scope\n- Global CLI contract and flag behavior\n- Output stream separation (stderr for humans, stdout for JSON/paths)\n- Exit code mapping (success/partial/conflict/system/invalid/interrupt)\n- XDG-compliant config/state/cache layout\n- Schema validation and default resolution rules\n\n## Non-goals\n- Implementing build/release logic (covered by other themes)\n- Host-specific tooling setup (Theme 2)\n\n## Success Criteria\n- [ ] Every command has a documented contract and JSON schema\n- [ ] All commands follow stream separation rules\n- [ ] Exit codes are consistent and tested\n- [ ] XDG paths are documented and validated","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T14:33:19.413802851Z","created_by":"ubuntu","updated_at":"2026-01-30T14:33:19.413802851Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.7","depends_on_id":"bd-1jt","type":"parent-child","created_at":"2026-01-30T14:33:19.413802851Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.7.1","title":"Define dsr CLI contract, exit codes, and JSON schema","description":"# Define dsr CLI Contract, Exit Codes, and JSON Schema\n\n## Goal\nCreate a single, authoritative contract that every `dsr` subcommand follows. This prevents automation breakage and makes logs/JSON outputs predictable.\n\n## Global Flags (apply to all commands)\n- `--json` : machine-readable output only on stdout\n- `--non-interactive` / `--yes` : disable prompts\n- `--dry-run` : show planned actions without mutating state\n- `--verbose` / `--quiet` : logging verbosity\n- `--log-level` : debug|info|warn|error\n- `--config` / `--state-dir` / `--cache-dir`\n- `--no-color`\n\n## Exit Code Contract\nAlign with AGENTS.md and keep consistent across commands:\n- `0` success\n- `1` partial failure (some repos/targets failed)\n- `2` conflicts (e.g., blocked by pending run/lock)\n- `3` dependency/system error (missing gh auth, docker, etc.)\n- `4` invalid arguments or config\n- `5` interrupted/aborted\n\n## JSON Output Contract (stdout only)\nRequired top-level fields:\n- `command`, `status`, `exit_code`\n- `run_id`, `started_at`, `duration_ms`\n- `tool` / `version` (when applicable)\n- `artifacts` (array with name/target/sha256/size)\n- `warnings` / `errors` (array with code + message)\n- `details` (command-specific payload)\n\n## Stream Separation\n- **stderr**: all human-readable output\n- **stdout**: JSON or paths only (never mix)\n\n## Considerations\n- Schemas must be backward-compatible (additive changes only)\n- `--json` should suppress human logs entirely\n- Provide sample outputs for each command\n\n## Success Criteria\n- [ ] CLI contract documented (README + `dsr help`)\n- [ ] JSON schema defined per command\n- [ ] Exit codes tested for all commands\n- [ ] Examples show stderr/stdout separation","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-30T14:33:35.926294049Z","created_by":"ubuntu","updated_at":"2026-01-30T15:07:05.750208339Z","closed_at":"2026-01-30T15:07:05.750189965Z","close_reason":"CLI contract documented in docs/CLI_CONTRACT.md, JSON schemas created in schemas/, test fixtures and validation script created","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.7.1","depends_on_id":"bd-1jt.7","type":"parent-child","created_at":"2026-01-30T14:33:35.926294049Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-1jt.7.2","title":"Implement dsr doctor: dependency + auth preflight checks","description":"# Implement `dsr doctor`: Dependency + Auth Preflight Checks\n\n## Purpose\nProvide a single command that verifies system readiness and catches failures before long-running builds/releases start.\n\n## Checks (minimum set)\n- `gh auth status` (interactive + `--hostname`) and token scopes\n- Git version + repo access (`git -C <repo> status`)\n- `jq`, `curl`, `ssh`, `docker`, `act` availability\n- Toolchain availability: Rust/Go/Bun (optional per-tool)\n- Disk space on local machine + build hosts\n- Network access to `api.github.com` and `github.com`\n- `minisign`, `syft`, `cosign` presence (if enabled)\n\n## Output Contract\n- Human summary to **stderr**\n- JSON to **stdout** when `--json`\n- Exit codes follow global contract (dependency/system error = 3)\n\n## Modes\n- `dsr doctor` (full)\n- `dsr doctor --quick` (only core deps + auth)\n- `dsr doctor --fix` (optional: install non-destructive deps)\n\n## Success Criteria\n- [ ] Detects missing dependencies with clear messages\n- [ ] Detects gh auth or permission failures\n- [ ] Produces JSON output for automation\n- [ ] Safe in non-interactive mode","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T14:33:44.481842827Z","created_by":"ubuntu","updated_at":"2026-01-30T14:33:44.481842827Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jt.7.2","depends_on_id":"bd-1jt.7","type":"parent-child","created_at":"2026-01-30T14:33:44.481842827Z","created_by":"ubuntu","metadata":"{}","thread_id":""}]}
{"id":"bd-3kr","title":"Implement dsr config command and configuration management","description":"# dsr Configuration Management\n\nCentralize dsr configuration. Config at ~/.config/dsr/ including config.yaml, repos.yaml, hosts.yaml. Commands: dsr config show/edit/validate/init. Environment overrides via DSR_* vars.\n\n## Success Criteria\n- [ ] Config loaded at startup\n- [ ] Environment overrides work\n- [ ] Validation catches errors","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-30T14:22:57.697466261Z","created_by":"ubuntu","updated_at":"2026-01-30T14:23:06.737659325Z","source_repo":".","deleted_at":"2026-01-30T14:23:06.737652281Z","deleted_by":"ubuntu","delete_reason":"delete","original_type":"task","compaction_level":0,"original_size":0}
